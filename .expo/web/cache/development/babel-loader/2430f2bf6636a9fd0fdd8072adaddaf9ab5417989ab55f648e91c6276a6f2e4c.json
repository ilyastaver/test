{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState, useContext } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport useStyles from \"./changeAvatar.module\";\nimport PlusSvg from \"../../../assets/icons/plusSvg\";\nimport CameraSvg from \"../../../assets/icons/cameraSvg\";\nimport * as ImagePicker from 'expo-image-picker';\nimport ImageViewer from \"../../ImageViewer/ImageViewer\";\nimport { ImageContext } from \"../../../context/ImageContext\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function ChangeAvatar() {\n  var _useContext = useContext(ImageContext),\n    updateSelectedImage = _useContext.updateSelectedImage;\n  var styles = useStyles();\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    permission = _useState2[0],\n    setRequestPermission = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    selectedImage = _useState4[0],\n    setSelectedImage = _useState4[1];\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      var cameraStatus = yield ImagePicker.requestMediaLibraryPermissionsAsync();\n      setRequestPermission(cameraStatus.status === 'granted');\n    })();\n    fetchSavedImage();\n  }, []);\n  var fetchSavedImage = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      try {\n        var savedImage = yield AsyncStorage.getItem('selected_image');\n        if (savedImage) {\n          setSelectedImage(savedImage);\n          updateSelectedImage(savedImage);\n        }\n      } catch (error) {\n        console.log('Error fetching saved image:', error);\n      }\n    });\n    return function fetchSavedImage() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var pickImageAsync = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      var result = yield ImagePicker.launchImageLibraryAsync({\n        allowsEditing: true,\n        quality: 1\n      });\n      if (!result.cancelled) {\n        setSelectedImage(result.uri);\n        updateSelectedImage(result.uri);\n        try {\n          yield AsyncStorage.setItem('selected_image', result.uri);\n        } catch (error) {\n          console.log('Error saving image:', error);\n        }\n      }\n    });\n    return function pickImageAsync() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var openCamera = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      var permissionResult = yield ImagePicker.requestCameraPermissionsAsync();\n      if (permissionResult.granted === false) {\n        alert(\"You've refused to allow this app to access your camera!\");\n        return;\n      }\n      var result = yield ImagePicker.launchCameraAsync();\n      if (!result.cancelled) {\n        setSelectedImage(result.uri);\n        updateSelectedImage(result.uri);\n        try {\n          yield AsyncStorage.setItem('selected_image', result.uri);\n        } catch (error) {\n          console.log('Error saving image:', error);\n        }\n      }\n    });\n    return function openCamera() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  return _jsx(View, {\n    style: styles.container,\n    children: _jsxs(View, {\n      style: styles.round,\n      children: [_jsxs(TouchableOpacity, {\n        onPress: pickImageAsync,\n        children: [!selectedImage && _jsx(View, {\n          style: styles.nonePhoto,\n          children: _jsx(PlusSvg, {})\n        }), selectedImage && _jsx(ImageViewer, {\n          isAvatar: true,\n          selectedImage: selectedImage\n        })]\n      }), _jsx(View, {\n        style: {\n          position: 'absolute',\n          bottom: 0,\n          right: 0\n        },\n        children: _jsx(TouchableOpacity, {\n          onPress: openCamera,\n          children: _jsx(CameraSvg, {})\n        })\n      })]\n    })\n  });\n}","map":{"version":3,"names":["React","useEffect","useState","useContext","View","TouchableOpacity","useStyles","PlusSvg","CameraSvg","ImagePicker","ImageViewer","ImageContext","AsyncStorage","jsx","_jsx","jsxs","_jsxs","ChangeAvatar","_useContext","updateSelectedImage","styles","_useState","_useState2","_slicedToArray","permission","setRequestPermission","_useState3","_useState4","selectedImage","setSelectedImage","_asyncToGenerator","cameraStatus","requestMediaLibraryPermissionsAsync","status","fetchSavedImage","_ref2","savedImage","getItem","error","console","log","apply","arguments","pickImageAsync","_ref3","result","launchImageLibraryAsync","allowsEditing","quality","cancelled","uri","setItem","openCamera","_ref4","permissionResult","requestCameraPermissionsAsync","granted","alert","launchCameraAsync","style","container","children","round","onPress","nonePhoto","isAvatar","position","bottom","right"],"sources":["C:/Users/ilias/OneDrive/Рабочий стол/messenger_project/Application/Client/components/Avatar/ChangeAvatar/changeAvatar.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\r\nimport { View, TouchableOpacity } from 'react-native';\r\nimport useStyles from './changeAvatar.module';\r\nimport PlusSvg from '../../../assets/icons/plusSvg';\r\nimport CameraSvg from '../../../assets/icons/cameraSvg';\r\nimport * as ImagePicker from 'expo-image-picker';\r\nimport ImageViewer from '../../ImageViewer/ImageViewer';\r\nimport { ImageContext } from '../../../context/ImageContext';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\nexport default function ChangeAvatar() {\r\n  const { updateSelectedImage } = useContext(ImageContext);\r\n  const styles = useStyles();\r\n  const [permission, setRequestPermission] = useState(null);\r\n  const [selectedImage, setSelectedImage] = useState(null);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      const cameraStatus = await ImagePicker.requestMediaLibraryPermissionsAsync();\r\n      setRequestPermission(cameraStatus.status === 'granted');\r\n    })();\r\n    fetchSavedImage();\r\n  }, []);\r\n\r\n  const fetchSavedImage = async () => {\r\n    try {\r\n      const savedImage = await AsyncStorage.getItem('selected_image');\r\n      if (savedImage) {\r\n        setSelectedImage(savedImage);\r\n        updateSelectedImage(savedImage); // Update the selected image in the context\r\n      }\r\n    } catch (error) {\r\n      console.log('Error fetching saved image:', error);\r\n    }\r\n  };\r\n\r\n  const pickImageAsync = async () => {\r\n    let result = await ImagePicker.launchImageLibraryAsync({\r\n      allowsEditing: true,\r\n      quality: 1,\r\n    });\r\n\r\n    if (!result.cancelled) {\r\n      setSelectedImage(result.uri);\r\n      updateSelectedImage(result.uri); // Update the selected image in the context\r\n      try {\r\n        await AsyncStorage.setItem('selected_image', result.uri);\r\n      } catch (error) {\r\n        console.log('Error saving image:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const openCamera = async () => {\r\n    const permissionResult = await ImagePicker.requestCameraPermissionsAsync();\r\n\r\n    if (permissionResult.granted === false) {\r\n      alert(\"You've refused to allow this app to access your camera!\");\r\n      return;\r\n    }\r\n\r\n    const result = await ImagePicker.launchCameraAsync();\r\n\r\n    if (!result.cancelled) {\r\n      setSelectedImage(result.uri);\r\n      updateSelectedImage(result.uri); // Update the selected image in the context\r\n      try {\r\n        await AsyncStorage.setItem('selected_image', result.uri);\r\n      } catch (error) {\r\n        console.log('Error saving image:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.round}>\r\n        <TouchableOpacity onPress={pickImageAsync}>\r\n          {!selectedImage && (\r\n            <View style={styles.nonePhoto}>\r\n              <PlusSvg />\r\n            </View>\r\n          )}\r\n          {selectedImage && <ImageViewer isAvatar={true} selectedImage={selectedImage} />}\r\n        </TouchableOpacity>\r\n        <View style={{ position: 'absolute', bottom: 0, right: 0 }}>\r\n          <TouchableOpacity onPress={openCamera}>\r\n            <CameraSvg />\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}