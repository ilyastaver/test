{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport React, { useEffect, useMemo } from 'react';\nimport { useBlurhash } from \"../utils/blurhash/useBlurhash\";\nimport { isBlurhashString, isThumbhashString } from \"../utils/resolveSources\";\nimport { thumbHashStringToDataURL } from \"../utils/thumbhash/thumbhash\";\nfunction ensureUnit(value) {\n  var trimmedValue = String(value).trim();\n  if (trimmedValue.endsWith('%')) {\n    return trimmedValue;\n  }\n  return trimmedValue + \"px\";\n}\nfunction getObjectPositionFromContentPositionObject(contentPosition) {\n  var resolvedPosition = _objectSpread({}, contentPosition);\n  if (!resolvedPosition) {\n    return '50% 50%';\n  }\n  if (resolvedPosition.top == null && resolvedPosition.bottom == null) {\n    resolvedPosition.top = '50%';\n  }\n  if (resolvedPosition.left == null && resolvedPosition.right == null) {\n    resolvedPosition.left = '50%';\n  }\n  return ['top', 'bottom', 'left', 'right'].map(function (key) {\n    if (key in resolvedPosition) {\n      return key + \" \" + ensureUnit(resolvedPosition[key]);\n    }\n    return '';\n  }).join(' ') || '50% 50%';\n}\nfunction getFetchPriorityFromImagePriority() {\n  var priority = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'normal';\n  return priority && ['low', 'high'].includes(priority) ? priority : 'auto';\n}\nvar ImageWrapper = React.forwardRef(function (_ref, ref) {\n  var _source$uri;\n  var source = _ref.source,\n    events = _ref.events,\n    contentPosition = _ref.contentPosition,\n    hashPlaceholderContentPosition = _ref.hashPlaceholderContentPosition,\n    priority = _ref.priority,\n    style = _ref.style,\n    hashPlaceholderStyle = _ref.hashPlaceholderStyle,\n    className = _ref.className,\n    accessibilityLabel = _ref.accessibilityLabel;\n  useEffect(function () {\n    var _events$onMount;\n    events == null ? void 0 : (_events$onMount = events.onMount) == null ? void 0 : _events$onMount.forEach(function (e) {\n      return e == null ? void 0 : e();\n    });\n  }, []);\n  var isBlurhash = isBlurhashString((source == null ? void 0 : source.uri) || '');\n  var isThumbhash = isThumbhashString((source == null ? void 0 : source.uri) || '');\n  var isHash = isBlurhash || isThumbhash;\n  var thumbhash = source == null ? void 0 : (_source$uri = source.uri) == null ? void 0 : _source$uri.replace(/thumbhash:\\//, '');\n  var thumbhashUri = useMemo(function () {\n    return isThumbhash ? thumbHashStringToDataURL(thumbhash != null ? thumbhash : '') : null;\n  }, [thumbhash]);\n  var blurhashUri = useBlurhash(isBlurhash ? source == null ? void 0 : source.uri : null, source == null ? void 0 : source.width, source == null ? void 0 : source.height);\n  var objectPosition = getObjectPositionFromContentPositionObject(isHash ? hashPlaceholderContentPosition : contentPosition);\n  var uri = isHash ? blurhashUri != null ? blurhashUri : thumbhashUri : source == null ? void 0 : source.uri;\n  if (!uri) return null;\n  return React.createElement(\"img\", {\n    ref: ref,\n    alt: accessibilityLabel,\n    className: className,\n    src: uri || undefined,\n    key: source == null ? void 0 : source.uri,\n    style: _objectSpread(_objectSpread({\n      width: '100%',\n      height: '100%',\n      position: 'absolute',\n      left: 0,\n      right: 0,\n      objectPosition: objectPosition\n    }, style), isHash ? hashPlaceholderStyle : {}),\n    fetchpriority: getFetchPriorityFromImagePriority(priority || 'normal'),\n    onLoad: function onLoad(event) {\n      if (typeof window !== 'undefined') {\n        window.requestAnimationFrame(function () {\n          var _events$onLoad;\n          events == null ? void 0 : (_events$onLoad = events.onLoad) == null ? void 0 : _events$onLoad.forEach(function (e) {\n            return e == null ? void 0 : e(event);\n          });\n        });\n      } else {\n        var _events$onLoad2;\n        events == null ? void 0 : (_events$onLoad2 = events.onLoad) == null ? void 0 : _events$onLoad2.forEach(function (e) {\n          return e == null ? void 0 : e(event);\n        });\n      }\n    },\n    onTransitionEnd: function onTransitionEnd() {\n      var _events$onTransitionE;\n      return events == null ? void 0 : (_events$onTransitionE = events.onTransitionEnd) == null ? void 0 : _events$onTransitionE.forEach(function (e) {\n        return e == null ? void 0 : e();\n      });\n    },\n    onError: function onError() {\n      var _events$onError;\n      return events == null ? void 0 : (_events$onError = events.onError) == null ? void 0 : _events$onError.forEach(function (e) {\n        return e == null ? void 0 : e({\n          source: source || null\n        });\n      });\n    }\n  });\n});\nexport default ImageWrapper;","map":{"version":3,"names":["React","useEffect","useMemo","useBlurhash","isBlurhashString","isThumbhashString","thumbHashStringToDataURL","ensureUnit","value","trimmedValue","String","trim","endsWith","getObjectPositionFromContentPositionObject","contentPosition","resolvedPosition","_objectSpread","top","bottom","left","right","map","key","join","getFetchPriorityFromImagePriority","priority","arguments","length","undefined","includes","ImageWrapper","forwardRef","_ref","ref","_source$uri","source","events","hashPlaceholderContentPosition","style","hashPlaceholderStyle","className","accessibilityLabel","_events$onMount","onMount","forEach","e","isBlurhash","uri","isThumbhash","isHash","thumbhash","replace","thumbhashUri","blurhashUri","width","height","objectPosition","createElement","alt","src","position","fetchpriority","onLoad","event","window","requestAnimationFrame","_events$onLoad","_events$onLoad2","onTransitionEnd","_events$onTransitionE","onError","_events$onError"],"sources":["C:\\Users\\ilias\\OneDrive\\Рабочий стол\\messenger_project\\Application\\Client\\node_modules\\expo-image\\src\\web\\ImageWrapper.tsx"],"sourcesContent":["import React, { CSSProperties, SyntheticEvent, useEffect, Ref, useMemo } from 'react';\n\nimport {\n  ImageContentPositionObject,\n  ImageContentPositionValue,\n  ImageNativeProps,\n  ImageSource,\n} from '../Image.types';\nimport { useBlurhash } from '../utils/blurhash/useBlurhash';\nimport { isBlurhashString, isThumbhashString } from '../utils/resolveSources';\nimport { thumbHashStringToDataURL } from '../utils/thumbhash/thumbhash';\n\nfunction ensureUnit(value: string | number) {\n  const trimmedValue = String(value).trim();\n  if (trimmedValue.endsWith('%')) {\n    return trimmedValue;\n  }\n  return `${trimmedValue}px`;\n}\n\ntype KeysOfUnion<T> = T extends T ? keyof T : never;\n\nfunction getObjectPositionFromContentPositionObject(\n  contentPosition?: ImageContentPositionObject\n): string {\n  const resolvedPosition = { ...contentPosition } as Record<\n    KeysOfUnion<ImageContentPositionObject>,\n    ImageContentPositionValue\n  >;\n  if (!resolvedPosition) {\n    return '50% 50%';\n  }\n  if (resolvedPosition.top == null && resolvedPosition.bottom == null) {\n    resolvedPosition.top = '50%';\n  }\n  if (resolvedPosition.left == null && resolvedPosition.right == null) {\n    resolvedPosition.left = '50%';\n  }\n\n  return (\n    ['top', 'bottom', 'left', 'right']\n      .map((key) => {\n        if (key in resolvedPosition) {\n          return `${key} ${ensureUnit(resolvedPosition[key])}`;\n        }\n        return '';\n      })\n      .join(' ') || '50% 50%'\n  );\n}\n\nfunction getFetchPriorityFromImagePriority(priority: ImageNativeProps['priority'] = 'normal') {\n  return priority && ['low', 'high'].includes(priority) ? priority : 'auto';\n}\n\nconst ImageWrapper = React.forwardRef(\n  (\n    {\n      source,\n      events,\n      contentPosition,\n      hashPlaceholderContentPosition,\n      priority,\n      style,\n      hashPlaceholderStyle,\n      className,\n      accessibilityLabel,\n    }: {\n      source?: ImageSource | null;\n      events?: {\n        onLoad?: (((event: SyntheticEvent<HTMLImageElement, Event>) => void) | undefined | null)[];\n        onError?: ((({ source }: { source: ImageSource | null }) => void) | undefined | null)[];\n        onTransitionEnd?: ((() => void) | undefined | null)[];\n        onMount?: ((() => void) | undefined | null)[];\n      };\n      contentPosition?: ImageContentPositionObject;\n      hashPlaceholderContentPosition?: ImageContentPositionObject;\n      priority?: string | null;\n      style: CSSProperties;\n      hashPlaceholderStyle?: CSSProperties;\n      className?: string;\n      accessibilityLabel?: string;\n    },\n    ref: Ref<HTMLImageElement>\n  ) => {\n    useEffect(() => {\n      events?.onMount?.forEach((e) => e?.());\n    }, []);\n    const isBlurhash = isBlurhashString(source?.uri || '');\n    const isThumbhash = isThumbhashString(source?.uri || '');\n    const isHash = isBlurhash || isThumbhash;\n\n    // Thumbhash uri always has to start with 'thumbhash:/'\n    const thumbhash = source?.uri?.replace(/thumbhash:\\//, '');\n    const thumbhashUri = useMemo(\n      () => (isThumbhash ? thumbHashStringToDataURL(thumbhash ?? '') : null),\n      [thumbhash]\n    );\n\n    const blurhashUri = useBlurhash(isBlurhash ? source?.uri : null, source?.width, source?.height);\n    const objectPosition = getObjectPositionFromContentPositionObject(\n      isHash ? hashPlaceholderContentPosition : contentPosition\n    );\n\n    const uri = isHash ? blurhashUri ?? thumbhashUri : source?.uri;\n    if (!uri) return null;\n    return (\n      <img\n        ref={ref}\n        alt={accessibilityLabel}\n        className={className}\n        src={uri || undefined}\n        key={source?.uri}\n        style={{\n          width: '100%',\n          height: '100%',\n          position: 'absolute',\n          left: 0,\n          right: 0,\n          objectPosition,\n          ...style,\n          ...(isHash ? hashPlaceholderStyle : {}),\n        }}\n        // @ts-ignore\n        // eslint-disable-next-line react/no-unknown-property\n        fetchpriority={getFetchPriorityFromImagePriority(priority || 'normal')}\n        onLoad={(event) => {\n          if (typeof window !== 'undefined') {\n            // this ensures the animation will run, since the starting class is applied at least 1 frame before the target class set in the onLoad event callback\n            window.requestAnimationFrame(() => {\n              events?.onLoad?.forEach((e) => e?.(event));\n            });\n          } else {\n            events?.onLoad?.forEach((e) => e?.(event));\n          }\n        }}\n        onTransitionEnd={() => events?.onTransitionEnd?.forEach((e) => e?.())}\n        onError={() => events?.onError?.forEach((e) => e?.({ source: source || null }))}\n      />\n    );\n  }\n);\nexport default ImageWrapper;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}