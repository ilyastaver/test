(()=>{"use strict";var e={6960:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Yt});var r=n(4942),o=n(885),a=n(5861),i=n(2321),l=n(7920),s=n(703),c=n(4043),u=n(7198),d=n.n(u),f=n(8482);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const g=function(e){return(0,f.jsxs)(d(),p(p({xmlns:"http://www.w3.org/2000/svg",width:588,height:285,fill:"none"},e),{},{children:[(0,f.jsx)(u.Path,{fill:"#000",d:"M92.94 177V87.4h12.8v78.464h48.512V177H92.94Zm74.208 0v-67.84h12.288V177h-12.288Zm6.144-80.896c-2.389 0-4.395-.768-6.016-2.304-1.536-1.536-2.304-3.413-2.304-5.632 0-2.304.768-4.224 2.304-5.76 1.621-1.536 3.627-2.304 6.016-2.304 2.389 0 4.352.768 5.888 2.304 1.621 1.45 2.432 3.285 2.432 5.504 0 2.304-.768 4.267-2.304 5.888-1.536 1.536-3.541 2.304-6.016 2.304Zm65.83 12.416c5.547 0 10.411 1.067 14.592 3.2 4.267 2.133 7.595 5.376 9.984 9.728 2.389 4.352 3.584 9.856 3.584 16.512V177h-12.288v-37.632c0-6.571-1.621-11.52-4.864-14.848-3.157-3.328-7.637-4.992-13.44-4.992-4.352 0-8.149.853-11.392 2.56-3.243 1.707-5.76 4.224-7.552 7.552-1.707 3.328-2.56 7.467-2.56 12.416V177h-12.288v-67.84h11.776v18.304l-1.92-4.864c2.219-4.437 5.632-7.893 10.24-10.368 4.608-2.475 9.984-3.712 16.128-3.712Zm60.885 52.096.256-15.744 39.04-35.712h14.848l-29.952 29.44-6.656 5.632-17.536 16.384ZM290.023 177V82.024h12.288V177h-12.288Zm51.84 0-26.624-33.024 7.936-9.856L356.967 177h-15.104Zm27.035 0v-67.84h12.288V177h-12.288Zm6.144-80.896c-2.389 0-4.395-.768-6.016-2.304-1.536-1.536-2.304-3.413-2.304-5.632 0-2.304.768-4.224 2.304-5.76 1.621-1.536 3.627-2.304 6.016-2.304 2.389 0 4.352.768 5.888 2.304 1.621 1.45 2.432 3.285 2.432 5.504 0 2.304-.768 4.267-2.304 5.888-1.536 1.536-3.541 2.304-6.016 2.304Zm65.83 12.416c5.547 0 10.411 1.067 14.592 3.2 4.267 2.133 7.595 5.376 9.984 9.728 2.389 4.352 3.584 9.856 3.584 16.512V177h-12.288v-37.632c0-6.571-1.621-11.52-4.864-14.848-3.157-3.328-7.637-4.992-13.44-4.992-4.352 0-8.149.853-11.392 2.56-3.243 1.707-5.76 4.224-7.552 7.552-1.707 3.328-2.56 7.467-2.56 12.416V177h-12.288v-67.84h11.776v18.304l-1.92-4.864c2.219-4.437 5.632-7.893 10.24-10.368 4.608-2.475 9.984-3.712 16.128-3.712Zm80.597 94.08a62.083 62.083 0 0 1-18.176-2.688c-5.803-1.707-10.539-4.181-14.208-7.424l5.888-9.472c3.157 2.731 7.04 4.864 11.648 6.4 4.608 1.621 9.429 2.432 14.464 2.432 8.021 0 13.909-1.877 17.664-5.632 3.755-3.755 5.632-9.472 5.632-17.152v-14.336l1.28-13.44-.64-13.568v-18.56h11.648v58.624c0 11.947-2.987 20.736-8.96 26.368-5.973 5.632-14.72 8.448-26.24 8.448Zm-1.536-28.416c-6.571 0-12.459-1.365-17.664-4.096-5.12-2.816-9.216-6.699-12.288-11.648-2.987-4.949-4.48-10.667-4.48-17.152 0-6.571 1.493-12.288 4.48-17.152 3.072-4.949 7.168-8.789 12.288-11.52 5.205-2.731 11.093-4.096 17.664-4.096 5.803 0 11.093 1.195 15.872 3.584 4.779 2.304 8.576 5.888 11.392 10.752 2.901 4.864 4.352 11.008 4.352 18.432 0 7.339-1.451 13.44-4.352 18.304-2.816 4.864-6.613 8.533-11.392 11.008-4.779 2.389-10.069 3.584-15.872 3.584Zm1.408-10.752c4.523 0 8.533-.939 12.032-2.816 3.499-1.877 6.229-4.48 8.192-7.808 2.048-3.328 3.072-7.168 3.072-11.52 0-4.352-1.024-8.192-3.072-11.52-1.963-3.328-4.693-5.888-8.192-7.68-3.499-1.877-7.509-2.816-12.032-2.816s-8.576.939-12.16 2.816c-3.499 1.792-6.272 4.352-8.32 7.68-1.963 3.328-2.944 7.168-2.944 11.52 0 4.352.981 8.192 2.944 11.52 2.048 3.328 4.821 5.931 8.32 7.808 3.584 1.877 7.637 2.816 12.16 2.816Z"}),(0,f.jsx)(u.Path,{fill:"#0076B9",d:"M228.523 201.561a5 5 0 0 1 1.447-7.4l11.54-6.661a5 5 0 0 1 6.83 1.83l50.17 86.906a4.732 4.732 0 0 1-7.834 5.27l-62.153-79.945Z"}),(0,f.jsx)(u.Path,{fill:"#000",fillOpacity:.2,d:"M228.523 201.561a5 5 0 0 1 1.447-7.4l11.54-6.661a5 5 0 0 1 6.83 1.83l50.17 86.906a4.732 4.732 0 0 1-7.834 5.27l-62.153-79.945Z"}),(0,f.jsx)(u.Path,{fill:"#0076B9",d:"M256.664 213.001A139 139 0 0 1 .512 150.914 138.998 138.998 0 0 1 168.54 3.175a139.003 139.003 0 0 1 73.756 42.814l-24.723 22.262A105.735 105.735 0 0 0 96.909 42.008 105.731 105.731 0 1 0 228.502 195.29l28.162 17.711Z"}),(0,f.jsx)(u.Path,{fill:"#000",fillOpacity:.2,d:"M256.664 213.001A139 139 0 0 1 .512 150.914 138.998 138.998 0 0 1 168.54 3.175a139.003 139.003 0 0 1 73.756 42.814l-24.723 22.262A105.735 105.735 0 0 0 96.909 42.008 105.731 105.731 0 1 0 228.502 195.29l28.162 17.711Z"})]}))};var y=n(939),m=n(9948);var j=n(6863),b=n(3743);function w(e){var t=e.title,n=e.onPress,r=e.disabled,o=function(e){var t=.1*m.default.get("window").width,n=e?"rgba(0, 0, 0, 0.35)":"rgba(0, 118, 185, 0.35)";return y.default.create({button:{backgroundColor:n,borderRadius:14,minWidth:t,paddingVertical:10,paddingHorizontal:20,alignSelf:"right",marginVertical:10,marginRight:20},buttonText:{fontFamily:"Montserrat-Regular",color:"#000000",fontSize:24,textAlign:"center"}})}(r);return(0,f.jsx)(b.default,{style:o.button,onPress:n,disabled:r,children:(0,f.jsx)(j.default,{style:o.buttonText,children:t})})}function v(){var e=(0,i.useState)(window.innerWidth),t=(0,o.default)(e,2),n=(t[0],t[1]),r=(0,i.useState)(window.innerHeight),a=(0,o.default)(r,2),l=(a[0],a[1]);return(0,i.useEffect)((function(){var e=function(){n(window.innerWidth),l(window.innerHeight)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),y.default.create({container:{flex:1,backgroundColor:"#FFFFFF",justifyContent:"center",alignItems:"center"},headerButton:{marginTop:30},containerMain:{flex:1,backgroundColor:"rgba(0, 118, 185, 0.35)",justifyContent:"center",alignItems:"center"},bottomLeft:{position:"absolute",bottom:20,left:20},topLeft:{position:"absolute",top:20,left:20},textContainer:{backgroundColor:"#FFFFFF",borderRadius:35,padding:30,shadowColor:"#000",shadowOffset:{width:2,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:7,position:"absolute",top:"30%",alignSelf:"auto",alignItems:"center",justifyContent:"center"},messageContainer:{backgroundColor:"#FFFFFF",borderRadius:35,padding:20,shadowColor:"#000",shadowOffset:{width:2,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:7,position:"absolute",top:"30%",width:"40%",height:"40%",justifyContent:"center",alignItems:"center"},text:{fontFamily:"Montserrat-Regular",color:"#000000",fontSize:24,textAlign:"center"},inputContainer:{width:"80%",alignItems:"center",justifyContent:"flex-start",paddingTop:20}})}var x=n(7158),O=(0,i.createContext)(),P=function(e){var t=e.children,n=(0,i.useState)(null),r=(0,o.default)(n,2),a=r[0],l=r[1];(0,i.useEffect)((function(){var e=localStorage.getItem("selectedImage");e&&l(JSON.parse(e))}),[]);return(0,f.jsx)(O.Provider,{value:{selectedImage:a,updateSelectedImage:function(e){l(e),localStorage.setItem("selectedImage",JSON.stringify(e))}},children:t})},C=(0,i.createContext)(),S=function(e){var t=e.children,n=(0,i.useState)(!1),r=(0,o.default)(n,2),l=r[0],s=r[1],c=(0,i.useState)(null),u=(0,o.default)(c,2),d=u[0],h=u[1],p=(0,i.useContext)(O).updateSelectedImage;(0,i.useEffect)((function(){g()}),[]);var g=function(){var e=(0,a.default)((function*(){try{var e=yield x.default.getItem("isLoggedIn"),t=yield x.default.getItem("user");"true"===e&&t&&(s(!0),h(JSON.parse(t)))}catch(n){console.error("Error during checkLoginStatus:",n)}}));return function(){return e.apply(this,arguments)}}(),y=function(){var e=(0,a.default)((function*(e){s(!0),h(e);try{yield x.default.clear(),yield x.default.setItem("isLoggedIn","true"),yield x.default.setItem("user",JSON.stringify(e))}catch(t){console.error("Error during login:",t)}}));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=(0,a.default)((function*(){s(!1),h(null),p(null);try{yield x.default.removeItem("isLoggedIn"),yield x.default.removeItem("user"),navigation.navigate("Auth")}catch(e){console.error("Error during logout:",e)}}));return function(){return e.apply(this,arguments)}}(),j={isLoggedIn:l,user:d,login:y,logout:m,updateUser:function(e){h(e)}};return(0,f.jsx)(C.Provider,{value:j,children:t})};const F=C;const k=function(e){var t=e.navigation,n=v();return(0,i.useContext)(F).isLoggedIn?(t.navigate("MainAuth"),null):(0,f.jsxs)(c.default,{style:n.container,children:[(0,f.jsx)(g,{}),(0,f.jsx)(c.default,{style:n.headerButton,children:(0,f.jsx)(w,{title:"\u041d\u0430\u0447\u0430\u0442\u044c",onPress:function(){return t.navigate("MainUnauth")}})})]})};function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const I=function(e){return(0,f.jsxs)(d(),D(D({xmlns:"http://www.w3.org/2000/svg",width:72,height:72,fill:"none"},e),{},{children:[(0,f.jsx)(u.Circle,{cx:36,cy:36,r:36,fill:"#0076B9"}),(0,f.jsx)(u.Circle,{cx:36,cy:36,r:36,fill:"#000",fillOpacity:.2}),(0,f.jsx)(u.Path,{fill:"#fff",d:"M15 55.444v-8.5l24.5-23 8.5 8-24.5 23.5H15ZM52 27.944l-8.5-8s2.5-2.5 4.5-3.5 4 0 4 0 4 1.5 4 3.5.5 3 0 4-4 4-4 4Z"}),(0,f.jsx)(u.Path,{stroke:"#fff",strokeWidth:1.9,d:"M15 55.444v-8.5l24.5-23 8.5 8-24.5 23.5H15ZM52 27.944l-8.5-8s2.5-2.5 4.5-3.5 4 0 4 0 4 1.5 4 3.5.5 3 0 4-4 4-4 4Z"})]}))};var B=n(5987),M=n(2102),R=n(5729),z=n(7086),L=n(4617);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const V=function(e){return(0,f.jsx)(d(),A(A({xmlns:"http://www.w3.org/2000/svg",width:32,height:32,fill:"none"},e),{},{children:(0,f.jsx)(u.Path,{fill:"#7C858E",d:"M25.253 23.026 32 29.77 29.771 32l-6.745-6.747a14.114 14.114 0 0 1-8.849 3.102C6.351 28.355 0 22.003 0 14.177 0 6.351 6.351 0 14.177 0s14.178 6.351 14.178 14.177a14.114 14.114 0 0 1-3.102 8.849Zm-3.16-1.17a10.99 10.99 0 0 0 3.111-7.679c0-6.093-4.935-11.026-11.027-11.026-6.093 0-11.026 4.933-11.026 11.026 0 6.092 4.933 11.027 11.026 11.027a10.99 10.99 0 0 0 7.68-3.11l.236-.237Z"})}))};function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const H=function(e){return(0,f.jsx)(d(),W(W({xmlns:"http://www.w3.org/2000/svg",width:33,height:33,fill:"none"},e),{},{children:(0,f.jsx)(u.Path,{stroke:"#000",strokeWidth:1.9,d:"m1 1 31 31M1 1v31M1 1h31m0 31H1m31 0V1M1 32 32 1"})}))};var Z=n(1066);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const J=function(e){return(0,f.jsx)(d(),_(_({xmlns:"http://www.w3.org/2000/svg",width:37,height:37,fill:"none"},e),{},{children:(0,f.jsx)(u.Path,{fill:"#fff",d:"M35.303 14.924v6.032H.704v-6.032h34.599ZM21.228.19v36.748h-6.414V.19h6.413Z"})}))};function G(e){var t=e.imageUrl,n=function(e){var t=(0,L.default)(),n=(t.width,t.height,e.profile),r=n?90:40,o=n?r:40,a=n?r:40,i=n?r:90,l=n?r:90;return y.default.create({container:{flexDirection:"row"},image:{width:o,height:a,borderRadius:100},round:{padding:5,borderRadius:100,marginRight:10,borderWidth:1,borderColor:"#0076B9"},nonePhoto:{height:l,width:i,backgroundColor:"#D9D9D9",borderRadius:100,justifyContent:"center",alignItems:"center"},info:{marginTop:10,flexDirection:"column"},nickname:{fontSize:20,fontWeight:"bold",marginBottom:5,marginTop:4},dateOfBirth:{fontSize:14,color:"#999999"}})}({profile:e.profile}),r=((0,i.useContext)(O).selectedImage,(0,i.useContext)(F).user);return(0,f.jsx)(c.default,{style:n.container,children:(0,f.jsx)(c.default,{style:n.round,children:function(){if(t&&t.startsWith("data:image"))return(0,f.jsx)(Z.default,{style:n.image,source:{uri:t}});if(t)return(0,f.jsx)(Z.default,{style:n.image,source:{uri:"data:image/jpeg;base64,"+t}});if(r.image){var e="data:image/jpeg;base64,"+r.image;return(0,f.jsx)(Z.default,{style:n.image,source:{uri:e}})}return(0,f.jsx)(c.default,{style:n.nonePhoto,children:(0,f.jsx)(J,{style:{transform:[{scale:.5}]}})})}()})})}function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const q=function(e){return(0,f.jsxs)(d(),$($({xmlns:"http://www.w3.org/2000/svg",width:62,height:63,fill:"none"},e),{},{children:[(0,f.jsx)(u.Circle,{cx:31,cy:31.445,r:30,stroke:"#000",strokeWidth:2}),(0,f.jsx)(u.Path,{stroke:"#000",strokeWidth:2,d:"m16.5 16.944 28.5 28.5m-28.5 0 28.5-28.5"})]}))};function X(e){var t=e.data,n=i.useState(!1),r=(0,o.default)(n,2),a=r[0],l=r[1],s=t.avatarUrl,u=t.username,d=(t.channelName,t.onPress),h=t.containerStyle,p=t.main,g=t.id,m=function(){var e=(0,L.default)();return e.width,e.height,y.default.create({container:{backgroundColor:"#FFFFFF",borderRadius:26,paddingVertical:12,paddingHorizontal:16},rowContainer:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},avatarContainer:{flexDirection:"row",alignItems:"center"},username:{fontFamily:"Montserrat-Regular",fontSize:24,fontWeight:"bold",marginLeft:8},channelName:{fontFamily:"Montserrat-Regular",fontSize:24,fontWeight:"bold"},deleteContainer:{marginLeft:"auto"}})}();return(0,f.jsx)(b.default,{style:[m.container,h,a&&{backgroundColor:"#E7DEDE"}],onPress:d,onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)},children:(0,f.jsxs)(c.default,{style:m.rowContainer,children:[s&&(0,f.jsxs)(c.default,{style:m.avatarContainer,children:[(0,f.jsx)(G,{imageUrl:s}),(0,f.jsx)(j.default,{style:m.username,children:u})]}),!s&&(0,f.jsx)(j.default,{style:m.channelName,children:u}),p&&(0,f.jsx)(c.default,{style:[m.deleteContainer,{transform:[{scale:.5}]}],children:(0,f.jsx)(b.default,{onPress:function(){fetch("https://messengerproject-production.up.railway.app/api/chats/delete/"+g,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("admin:root")}}).then((function(e){e.ok?(alert("Chat deleted successfully"),window.location.reload()):console.log("Failed to delete chat")})).catch((function(e){console.error("Error deleting chat:",e)}))},children:(0,f.jsx)(q,{})})})]})})}var K=n(6460),Q=["value","setValue","navigation","unauth"];function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e){var t=e.value,n=e.setValue,r=(e.navigation,e.unauth),l=(0,B.default)(e,Q),s=(0,i.useState)(!1),u=(0,o.default)(s,2),d=u[0],h=u[1],p=(0,i.useState)(!1),g=(0,o.default)(p,2),m=g[0],j=g[1],b=(0,K.useNavigation)(),w=function(){var e=(0,L.default)();return e.width,e.height,y.default.create({container:{flexDirection:"row",justifyContent:"center",alignItems:"center",backgroundColor:"#FFFFFF",zIndex:0},icon:{position:"absolute",left:10,zIndex:1},dismissIcon:{position:"absolute",right:10,top:"50%",transform:[{translateY:-17}],zIndex:2},dropdown:{position:"absolute",top:50,left:0,right:0,flex:1,maxHeight:300,overflowY:"auto",backgroundColor:"#FFFFFF",borderRadius:10,boxShadow:"2px 2px 2px rgba(0, 0, 0, 1)",zIndex:1,padding:10},input:{flex:1,fontFamily:"Montserrat-Regular",height:44,width:600,fontSize:20,paddingLeft:10,paddingRight:10,borderRadius:10,backgroundColor:"#FFFFFF",color:"#000000",boxShadow:"2px 2px 2px rgba(0, 0, 0, 1)"}})}(),v="admin",x="root",O=(0,i.useState)([]),P=(0,o.default)(O,2),C=P[0],S=P[1],F=(0,i.useState)([]),k=(0,o.default)(F,2),E=k[0],D=k[1];(0,i.useEffect)((function(){var e=function(){var e=(0,a.default)((function*(){try{var e=yield fetch("https://messengerproject-production.up.railway.app/api/channels",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(v+":"+x)}});if(e.ok){for(var t=yield e.json(),n=[],r=[],o=function*(){var e=t[a];n.push({name:e.name,onPress:function(){return t=e.id,void b.navigate("Channel",{channelId:t});var t},avatarUrl:null}),r.push({name:e.name,onPress:function(){return t=e.id,void b.navigate("ChannelUnauth",{channelId:t});var t},avatarUrl:null})},a=0;a<t.length;a++)yield*o();var i=yield fetch("https://messengerproject-production.up.railway.app/api/users",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(v+":"+x)}});if(i.ok)for(var l=yield i.json(),s=function*(){var e=l[c];n.push({name:e.name,onPress:function(){return t=e,void b.navigate("Chat",{chatUser:t});var t},avatarUrl:e.image})},c=0;c<l.length;c++)yield*s();else console.log("Failed to fetch user data");S(n),D(r)}else console.log("Failed to fetch channel data")}catch(u){console.log("Error fetching data:",u)}}));return function(){return e.apply(this,arguments)}}();e()}),[]);var I=t?(r?E:C).filter((function(e){return e.name.toLowerCase().includes(t.toLowerCase())})):r?E:C;return(0,f.jsxs)(c.default,{style:w.container,children:[(0,f.jsx)(c.default,{style:w.icon,children:(0,f.jsx)(V,{})}),(0,f.jsx)(M.default,te(te({},l),{},{placeholderTextColor:"#7C858E",value:t,style:[w.input,{paddingLeft:36}],onFocus:function(){h(!0),j(!0)},onChangeText:function(e){return n(e)}})),d&&(0,f.jsx)(R.default,{onPressIn:function(){n(""),h(!1),j(!1)},children:(0,f.jsx)(H,{style:w.dismissIcon})}),m&&(0,f.jsx)(z.default,{style:w.dropdown,children:I.map((function(e,t){return(0,f.jsx)(X,{data:{avatarUrl:e.avatarUrl,username:e.name,onPress:e.onPress}},t)}))})]})}function re(e){var t=e.navigation,n=v();return(0,f.jsxs)(c.default,{style:n.containerMain,children:[(0,f.jsx)(c.default,{style:n.messageContainer,children:(0,f.jsx)(j.default,{style:n.text,children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044c, \u0447\u0442\u043e\u0431\u044b \u043d\u0430\u0447\u0430\u0442\u044c \u043e\u0431\u0449\u0430\u0442\u044c\u0441\u044f"})}),(0,f.jsx)(c.default,{style:n.bottomLeft,children:(0,f.jsx)(b.default,{onPress:function(){return t.navigate("Auth")},children:(0,f.jsx)(I,{})})})]})}var oe=["value","setValue","type","flex"];function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function le(e){var t,n=e.value,r=e.setValue,o=e.type,a=e.flex,i=(0,B.default)(e,oe),l=function(){var e=(0,L.default)();return e.width,e.height,y.default.create({container:{flexDirection:"row",justifyContent:"center",alignItems:"center",backgroundColor:"#FFFFFF",borderRadius:10},input:{flex:1,fontFamily:"Montserrat-Regular",height:44,fontSize:16,paddingLeft:40,borderRadius:10,backgroundColor:"#FFFFFF",color:"#000000",boxShadow:"2px 2px 2px rgba(0, 0, 0, 1)",width:"80%"}})}();switch(o){case"password":t={secureTextEntry:!0,autoCompleteType:"password",maxLength:26};break;case"nickname":t={maxLength:10};break;case"email":t={autoCompleteType:"email",keyboardType:"email-address",maxLength:55};break;case"code":t={keyboardType:"number-pad",maxLength:4};break;default:t={}}var s=a?"90%":600;return(0,f.jsx)(c.default,{style:[l.container,{width:s,height:44}],children:(0,f.jsx)(M.default,ie(ie(ie({},i),t),{},{placeholderTextColor:"#7C858E",value:n,style:[l.input,{paddingLeft:21}],onChangeText:function(e){return r(e)}}))})}function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ue=function(e){var t=e.navigation,n=v(),r=(0,i.useState)({password:"",email:""}),a=(0,o.default)(r,2),l=a[0],s=a[1],u=l.email&&l.password,d=(0,i.useContext)(F).login;return(0,f.jsx)(c.default,{style:n.containerMain,children:(0,f.jsxs)(c.default,{style:n.textContainer,children:[(0,f.jsxs)(c.default,{style:n.inputContainer,children:[(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:l.email,setValue:function(e){return s(ce(ce({},l),{},{email:e}))},placeholder:"\u041f\u043e\u0447\u0442\u0430",type:"email",flex:!1})}),(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:l.password,setValue:function(e){return s(ce(ce({},l),{},{password:e}))},placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",flex:!1})})]}),(0,f.jsxs)(c.default,{style:{marginTop:13,marginRight:13},children:[(0,f.jsx)(b.default,{onPress:function(){return t.navigate("Forgot")},children:(0,f.jsx)(j.default,{style:{fontFamily:"Montserrat-Regular"},children:"\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"})}),(0,f.jsx)(c.default,{style:{borderBottomWidth:1,borderBottomColor:"black",width:"100%"}})]}),(0,f.jsx)(c.default,{children:(0,f.jsx)(w,{title:"\u0412\u043e\u0439\u0442\u0438",onPress:function(){var e={email:l.email,password:l.password};fetch("https://messengerproject-production.up.railway.app/api/login",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("admin:root")},body:JSON.stringify(e)}).then((function(e){e.ok?e.json().then((function(e){d(e)})):e.json().then((function(e){var t=e.message||"Login failed";alert(t)}))})).catch((function(e){console.error("Error:",e)}))},disabled:!u})}),(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(w,{title:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",onPress:function(){return t.navigate("Reg")}})})]})})};function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const he=function(e){var t=e.navigation,n=v(),r=(0,i.useState)({name:"",email:"",password:""}),a=(0,o.default)(r,2),l=a[0],s=a[1],u=l.name&&l.password&&l.email;return(0,f.jsx)(c.default,{style:n.containerMain,children:(0,f.jsxs)(c.default,{style:n.textContainer,children:[(0,f.jsxs)(c.default,{style:n.inputContainer,children:[(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:l.name,setValue:function(e){return s(fe(fe({},l),{},{name:e}))},placeholder:"\u041d\u0438\u043a\u043d\u0435\u0439\u043c",type:"nickname",flex:!1})}),(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:l.email,setValue:function(e){return s(fe(fe({},l),{},{email:e}))},placeholder:"\u041f\u043e\u0447\u0442\u0430",type:"email",flex:!1})}),(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:l.password,setValue:function(e){return s(fe(fe({},l),{},{password:e}))},placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",flex:!1})})]}),(0,f.jsx)(c.default,{children:(0,f.jsx)(w,{title:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",onPress:function(){if(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(l.email)){if(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/.test(l.password)){var e={name:l.name,email:l.email,password:l.password};fetch("https://messengerproject-production.up.railway.app/api/register",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("admin:root")},body:JSON.stringify(e)}).then((function(e){e.ok?t.navigate("Auth"):console.error("Registration failed")})).catch((function(e){console.error("Error:",e)}))}else alert("Invalid password: at least 8 characters long, should contain at least one uppercase letter, at least one lowercase letter,at least one digit, may contain special characters")}else alert("Invalid email format")},disabled:!u})})]})})};function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ye=function(e){var t=e.navigation,n=v(),r=(0,i.useState)({newPassword:"",email:"",confirmPassword:"",code:""}),l=(0,o.default)(r,2),s=l[0],u=l[1],d="admin",h="root",p=(0,i.useState)(""),g=(0,o.default)(p,2),y=g[0],m=g[1],j=function(){var e=(0,a.default)((function*(e){try{var t=yield fetch("https://messengerproject-production.up.railway.app/api/users/email?email="+e,{headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(d+":"+h)}});if(t.ok)return yield t.json();alert("User not found")}catch(n){throw console.error("Error getting user by email:",n),n}}));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=(0,a.default)((function*(e){try{var t=new URLSearchParams({new_password:s.newPassword}),n=yield fetch("https://messengerproject-production.up.railway.app/api/users/"+e+"/update/password?"+t.toString(),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(d+":"+h)},body:JSON.stringify({new_password:s.newPassword})});n.ok?alert("Password updated successfully"):n.json().then((function(e){var t=e.message;alert(t)}))}catch(r){console.error("Error updating password:",r)}}));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=(0,a.default)((function*(){if(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/.test(s.newPassword))try{var e=yield j(s.email);e?(yield b(e),alert("Password updated successfully")):alert("User not found"),t.navigate("Auth")}catch(n){alert("Error resetting password:",n)}else alert("Invalid password: at least 8 characters long, should contain at least one uppercase letter, at least one lowercase letter,at least one digit, may contain special characters")}));return function(){return e.apply(this,arguments)}}();return(0,f.jsx)(c.default,{style:n.containerMain,children:(0,f.jsxs)(c.default,{style:n.textContainer,children:[(0,f.jsxs)(c.default,{style:n.inputContainer,children:[(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:s.email,setValue:function(e){return u(ge(ge({},s),{},{email:e}))},placeholder:"\u041f\u043e\u0447\u0442\u0430",type:"email",flex:!1})}),(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:s.newPassword,setValue:function(e){return u(ge(ge({},s),{},{newPassword:e}))},placeholder:"\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",type:"password",flex:!1})}),(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:s.confirmPassword,setValue:function(e){return u(ge(ge({},s),{},{confirmPassword:e}))},placeholder:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c",type:"password",flex:!1})}),(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:s.code,setValue:function(e){return u(ge(ge({},s),{},{code:e}))},placeholder:"\u041a\u043e\u0434",type:"code",flex:!1})})]}),(0,f.jsx)(c.default,{children:(0,f.jsx)(w,{title:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c",onPress:x,disabled:!s.newPassword||!s.email||!s.confirmPassword||!s.code||s.newPassword!==s.confirmPassword||s.code!=y})}),(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(w,{title:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043a\u043e\u0434",onPress:function(){if(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(s.email)){var e=encodeURIComponent(s.email);fetch("https://messengerproject-production.up.railway.app/api/send_email?email="+e,{method:"GET",headers:{Authorization:"Basic "+btoa(d+":"+h)}}).then((function(e){return e.json()})).then((function(e){m(e),e?alert("Code has been sent to your email"):alert("Failed to get code")})).catch((function(e){console.error("Error getting code:",e),alert("Failed to get code")}))}else alert("Invalid email format")},disabled:!s.email})})]})})};function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const be=function(e){return(0,f.jsxs)(d(),je(je({xmlns:"http://www.w3.org/2000/svg",width:70,height:70,fill:"none"},e),{},{children:[(0,f.jsx)(u.Path,{fill:"#0076B9",d:"M54.06 50.77a2.655 2.655 0 1 1 4.468-2.846l10.958 20.058a1.117 1.117 0 0 1-1.88 1.198L54.06 50.77Z"}),(0,f.jsx)(u.Path,{fill:"#000",fillOpacity:.2,d:"M54.06 50.77a2.655 2.655 0 1 1 4.468-2.846l10.958 20.058a1.117 1.117 0 0 1-1.88 1.198L54.06 50.77Z"}),(0,f.jsx)(u.Path,{fill:"#0076B9",d:"M59.711 52.364c-3.608 6.062-8.927 10.773-15.205 13.468a30.717 30.717 0 0 1-19.786 1.55c-6.586-1.687-12.504-5.518-16.918-10.952C3.387 50.997.7 44.235.119 37.1c-.58-7.134.974-14.282 4.445-20.432 3.472-6.15 8.683-10.993 14.9-13.844C25.681-.026 32.588-.74 39.21.781c6.622 1.521 12.624 5.203 17.158 10.525l-5.751 5.473c-3.45-4.048-8.015-6.849-13.052-8.007a23.38 23.38 0 0 0-15.02 1.555c-4.729 2.169-8.693 5.852-11.334 10.53-2.64 4.679-3.823 10.115-3.38 15.543.441 5.427 2.485 10.57 5.843 14.703 3.358 4.133 7.86 7.047 12.87 8.33a23.364 23.364 0 0 0 15.05-1.18c4.775-2.049 8.821-5.632 11.565-10.243l6.552 4.354Z"}),(0,f.jsx)(u.Path,{fill:"#000",fillOpacity:.2,d:"M59.711 52.364c-3.608 6.062-8.927 10.773-15.205 13.468a30.717 30.717 0 0 1-19.786 1.55c-6.586-1.687-12.504-5.518-16.918-10.952C3.387 50.997.7 44.235.119 37.1c-.58-7.134.974-14.282 4.445-20.432 3.472-6.15 8.683-10.993 14.9-13.844C25.681-.026 32.588-.74 39.21.781c6.622 1.521 12.624 5.203 17.158 10.525l-5.751 5.473c-3.45-4.048-8.015-6.849-13.052-8.007a23.38 23.38 0 0 0-15.02 1.555c-4.729 2.169-8.693 5.852-11.334 10.53-2.64 4.679-3.823 10.115-3.38 15.543.441 5.427 2.485 10.57 5.843 14.703 3.358 4.133 7.86 7.047 12.87 8.33a23.364 23.364 0 0 0 15.05-1.18c4.775-2.049 8.821-5.632 11.565-10.243l6.552 4.354Z"})]}))};var we=n(6459),ve=n(4710);function xe(){var e=(0,i.useState)(window.innerWidth),t=(0,o.default)(e,2),n=(t[0],t[1]),r=(0,i.useState)(window.innerHeight),a=(0,o.default)(r,2),l=(a[0],a[1]);return(0,i.useEffect)((function(){var e=function(){n(window.innerWidth),l(window.innerHeight)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),y.default.create({container:{flex:1,backgroundColor:"#FFFFFF",justifyContent:"center",alignItems:"center"},headerButton:{marginTop:30},channNameContainer:{flexDirection:"row",justifyContent:"center",alignItems:"center",top:80,paddingLeft:10,overflow:"hidden",position:"absolute"},dataInputContainer:{marginRight:10},nicknameContainer:{flexDirection:"row",alignItems:"center",marginBottom:13},containerMain:{flex:1,backgroundColor:"rgba(0, 118, 185, 0.35)",justifyContent:"center",alignItems:"center"},containerSettings:{flex:1,justifyContent:"center",flexDirection:"row",alignItems:"center",backgroundColor:"rgba(0, 118, 185, 0.35)"},bottomLeft:{position:"absolute",bottom:20,left:20},topLeft:{position:"absolute",top:20,left:20},textContainer:{backgroundColor:"#FFFFFF",borderRadius:35,padding:30,shadowColor:"#000",shadowOffset:{width:2,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:7,position:"absolute",top:"30%",alignSelf:"auto",alignItems:"center",justifyContent:"center"},messageContainer:{backgroundColor:"#FFFFFF",borderRadius:35,width:"30%",height:"40%",overflow:"hidden",position:"absolute",top:40,right:80,shadowColor:"#000",shadowOffset:{width:2,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:7},barContainer:{backgroundColor:"#FFFFFF",borderRadius:35,width:"50%",height:"10%",overflow:"hidden",position:"absolute",top:40,right:80,shadowColor:"#000",shadowOffset:{width:2,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:7},barChanContainer:{backgroundColor:"#FFFFFF",borderRadius:35,width:"50%",height:"10%",overflow:"hidden",position:"absolute",top:40,right:80,shadowColor:"#000",shadowOffset:{width:2,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:7,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},barText:{fontFamily:"Montserrat-Regular",fontSize:24,paddingLeft:20},settingsContainer:{alignItems:"center",backgroundColor:"#FFFFFF",borderRadius:35,padding:20,shadowColor:"#000",shadowOffset:{width:2,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:7,backgroundColor:"#FFFFFF",borderRadius:35,width:"30%",height:"40%",overflow:"hidden",position:"absolute"},sendContainer:{width:"40%",height:"10%",position:"absolute",bottom:0,right:200,marginTop:50},forwardContainer:{backgroundColor:"#FFFFFF",padding:10,borderRadius:25,width:"35%",height:"45%",overflow:"hidden",position:"absolute",bottom:40,right:80,shadowColor:"#000",shadowOffset:{width:2,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:7},historyContainer:{backgroundColor:"#FFFFFF",padding:10,borderRadius:15,marginTop:30,width:"35%",height:"70%",overflow:"hidden",position:"absolute",top:"50%",right:225,transform:[{translateY:"-50%"}],shadowColor:"#000",shadowOffset:{width:2,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:7},profileContainer:{backgroundColor:"#FFFFFF",borderRadius:35,width:"20%",height:"50%",overflow:"hidden",position:"absolute",top:40,left:80,shadowColor:"#000",shadowOffset:{width:2,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:7,alignItems:"center",justifyContent:"center",paddingTop:60,paddingBottom:60},profileSettingsContainer:{backgroundColor:"#FFFFFF",borderRadius:35,width:"24%",overflow:"hidden",position:"absolute",shadowColor:"#000",shadowOffset:{width:2,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:7,alignItems:"center",justifyContent:"center",paddingTop:30,paddingBottom:30,alignSelf:"stretch",marginTop:"auto",marginBottom:"auto",left:"50%",top:"50%",transform:[{translateX:"-50%"},{translateY:"-50%"}]},popupContainer:{backgroundColor:"#E7DEDE",borderRadius:35,padding:20,shadowColor:"#000",shadowOffset:{width:2,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:7,position:"absolute",top:"50%",left:"50%",transform:[{translateX:"-50%"},{translateY:"-50%"}],width:"20%",height:"20%",justifyContent:"center",alignItems:"center",flexDirection:"column"},text:{fontFamily:"Montserrat-Regular",color:"#000000",fontSize:24,textAlign:"center",marginBottom:13},inputContainer:{width:"80%",alignItems:"center",justifyContent:"flex-start",paddingTop:20}})}function Oe(e){var t=e.data,n=t.onPress,r=t.text,o=function(){var e=(0,L.default)();return e.width,e.height,y.default.create({button:{borderTopWidth:1,borderBottomWidth:1,borderColor:"#000000",paddingHorizontal:10,paddingVertical:15},text:{fontFamily:"Montserrat-Regular",fontSize:36,color:"#000000",textAlign:"center"}})}();return(0,f.jsx)(b.default,{style:o.button,onPress:n,children:(0,f.jsx)(j.default,{style:o.text,children:r})})}const Pe=function(e){var t=e.data,n=t.imageUrl,r=t.nickname,a=t.message,l=t.own,s=t.from,u=t.id,d=function(){var e=(0,L.default)();return e.width,e.height,y.default.create({container:{flexDirection:"row",alignItems:"flex-end"},avatar:{alignSelf:"flex-start"},messageBox:{marginLeft:15,flex:1,backgroundColor:"#E7DEDE",borderLeftWidth:5,borderLeftColor:"#0076B9",paddingVertical:10,paddingHorizontal:15,marginBottom:10,maxWidth:"40%",borderTopRightRadius:10,borderBottomRightRadius:10},ownMessageBox:{backgroundColor:"rgba(0, 118, 185, 0.35)",borderLeftColor:"#0076B9",borderLeftWidth:5,marginLeft:15,flex:1,paddingVertical:10,paddingHorizontal:15,marginBottom:10,maxWidth:"40%",borderTopRightRadius:10,borderBottomRightRadius:10},nickname:{fontSize:24,fontFamily:"Montserrat-Regular",color:"black",fontWeight:"bold",marginBottom:5},ownNickname:{fontSize:24,fontFamily:"Montserrat-Regular",color:"black",fontWeight:"bold",marginBottom:5},message:{fontSize:19,fontFamily:"Montserrat-Regular",color:"black",flexWrap:"wrap",marginBottom:10},ownMessage:{fontSize:19,fontFamily:"Montserrat-Regular",color:"black",flexWrap:"wrap",marginBottom:10}})}(),h=(0,i.useState)(!1),p=(0,o.default)(h,2),g=p[0],m=p[1],b=(0,i.useContext)(F).user;return(0,f.jsxs)(c.default,{style:d.container,children:[l?null:(0,f.jsx)(G,{imageUrl:n,profile:!1,style:d.avatar}),(0,f.jsxs)(R.default,{style:[d.messageBox,l&&d.ownMessageBox],onPress:function(){m(!g)},children:[g&&(0,f.jsx)(R.default,{onPress:function(){var e=b.id;fetch("https://messengerproject-production.up.railway.app/api/saved_message/delete?user_id="+e+"&message_id="+u,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("admin:root")}}).then((function(e){e.ok?window.location.reload():console.log("Failed to delete message")})).catch((function(e){console.log("Error deleting message:",e)}))},children:(0,f.jsx)(j.default,{style:{fontFamily:"Montserrat-Italic"},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})}),(0,f.jsx)(j.default,{style:[d.nickname,l&&d.ownNickname],children:r}),(0,f.jsx)(j.default,{style:[d.message,l&&d.ownMessage],children:a}),(0,f.jsxs)(j.default,{style:{fontFamily:"Montserrat-Italic"},children:["Forwarded from: ",s]})]})]})};var Ce=n(2982),Se=(0,i.createContext)(),Fe=function(e){var t=e.children,n=(0,i.useState)([]),r=(0,o.default)(n,2),a=r[0],l=r[1];(0,i.useEffect)((function(){var e=localStorage.getItem("forwardedMessages");e&&l(JSON.parse(e))}),[]),(0,i.useEffect)((function(){localStorage.setItem("forwardedMessages",JSON.stringify(a))}),[a]);return(0,f.jsx)(Se.Provider,{value:{forwardedMessages:a,addForwardedMessage:function(e){l((function(t){return[].concat((0,Ce.default)(t),[e])}))},clearForwardedMessages:function(){l([])}},children:t})};function ke(){return(ke=(0,a.default)((function*(e){try{yield x.default.setItem("profile_nickname",e)}catch(t){console.log("Error saving nickname:",t)}}))).apply(this,arguments)}function Ee(){return De.apply(this,arguments)}function De(){return(De=(0,a.default)((function*(){try{return yield x.default.getItem("profile_nickname")}catch(e){return console.log("Error retrieving nickname:",e),null}}))).apply(this,arguments)}function Ie(){return(Ie=(0,a.default)((function*(e){try{yield x.default.setItem("profile_email",e)}catch(t){console.log("Error saving email:",t)}}))).apply(this,arguments)}function Be(){return(Be=(0,a.default)((function*(){try{return yield x.default.getItem("profile_email")}catch(e){return console.log("Error retrieving email:",e),null}}))).apply(this,arguments)}function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ze(e){var t,n,r=e.navigation,l=xe(),s=(0,i.useState)(!1),u=(0,o.default)(s,2),d=u[0],h=u[1],p=(0,i.useState)({nickname:""}),g=(0,o.default)(p,2),y=g[0],m=g[1],v=(0,i.useContext)(F),x=v.user,P=v.updateUser,C=v.logout,S=(0,i.useState)(""),k=(0,o.default)(S,2),E=k[0],D=k[1],B="admin",M="root",R=(0,i.useCallback)((function(e){return P(e)}),[P]),L=(0,i.useContext)(O).selectedImage;(0,K.useFocusEffect)(i.useCallback((function(){T(),A()}),[]));var T=function(){var e=(0,a.default)((function*(){try{var e=yield fetch("https://messengerproject-production.up.railway.app/api/users/"+x.id,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(B+":"+M)}});if(e.ok){var t=yield e.json();console.log(t),R(t)}else console.log("Failed to fetch user data")}catch(n){console.error("Error fetching user data:",n)}}));return function(){return e.apply(this,arguments)}}(),A=function(){var e=(0,a.default)((function*(){try{var e=yield Ee();e&&e!==E&&D(e)}catch(t){console.log("Error retrieving profile nickname:",t)}}));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,a.default)((function*(){try{(yield fetch("https://messengerproject-production.up.railway.app/api/saved_message/delete_all?user_id="+(null==x?void 0:x.id),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(B+":"+M)}})).ok?(console.log("Messages deleted successfully"),window.location.reload()):console.log("Failed to delete messages")}catch(e){console.log("Error deleting messages:",e)}}));return function(){return e.apply(this,arguments)}}(),U=y.nickname,W=[{onPress:function(e){return(0,we.default)(e),r.navigate("Profile")},text:"\u041c\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"},{onPress:function(){return C()},text:"\u0412\u044b\u0439\u0442\u0438"}],H=function(){var e=(0,a.default)((function*(){try{var e=yield fetch("https://messengerproject-production.up.railway.app/api/channels/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(B+":"+M)},body:JSON.stringify({username:x.name,channelName:y.nickname})});if(e.ok){yield e.json();h(!1),alert("Channel created"),window.location.reload()}else alert("Failed to create channel")}catch(t){alert("Error creating channel:",t)}}));return function(){return e.apply(this,arguments)}}();x.image;return(0,f.jsxs)(c.default,{style:l.containerMain,children:[(0,f.jsx)(c.default,{style:l.messageContainer,children:(0,f.jsxs)(z.default,{style:{flex:1,scrollbarWidth:0,flexDirection:"column"},children:[x.channels.map((function(e){return(0,f.jsx)(X,{data:{username:e.name,onPress:function(){return r.navigate("Channel",{channelId:e.id})}}},e.id)})),x.chats.map((function(e){return e.userSecond.name===x.name?(0,f.jsx)(X,{data:{avatarUrl:e.userFirst.image,username:e.userFirst.name,onPress:function(){return r.navigate("Chat",{chatUser:e.userFirst})},main:!0,id:e.id}},e.id):(0,f.jsx)(X,{data:{avatarUrl:e.userSecond.image,username:e.userSecond.name,onPress:function(){return r.navigate("Chat",{chatUser:e.userSecond})},main:!0,id:e.id}},e.id)}))]})}),(0,f.jsxs)(c.default,{style:l.profileContainer,children:[(0,f.jsx)(G,{imageUrl:L,profile:!0}),(0,f.jsx)(j.default,{style:{color:"#000000",fontSize:48,textAlign:"center",marginBottom:13,fontFamily:"Montserrat-Regular"},children:E||x.name}),W.map((function(e,t){return(0,f.jsx)(c.default,{style:{width:"70%"},children:(0,f.jsx)(Oe,{data:e})},t)}))]}),(0,f.jsxs)(c.default,{style:l.forwardContainer,children:[(null==x||null==(t=x.savedMessages)?void 0:t.length)>0&&(0,f.jsx)(c.default,{style:{right:50,position:"absolute",zIndex:1},children:(0,f.jsx)(b.default,{onPress:V,children:(0,f.jsx)(q,{})})}),(0,f.jsx)(z.default,{style:{flex:1,scrollbarWidth:0,flexDirection:"column"},children:null==x||null==(n=x.savedMessages)?void 0:n.map((function(e){var t,n,r,o;return(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(Pe,{data:{imageUrl:null==(t=e.sender)?void 0:t.image,nickname:null==(n=e.sender)?void 0:n.name,message:e.data,own:(null==(r=e.sender)?void 0:r.name)===x.name,from:e.chat?(null==(o=e.sender)?void 0:o.name)===x.name?e.chat.userSecond.name:e.chat.userFirst.name:e.channel.name,id:e.id}},e.id)})}))})]}),(0,f.jsx)(c.default,{style:l.bottomLeft,children:(0,f.jsx)(b.default,{onPress:function(){return h(!0)},children:(0,f.jsx)(I,{})})}),(0,f.jsx)(ve.default,{visible:d,transparent:!0,children:(0,f.jsxs)(c.default,{style:l.popupContainer,children:[(0,f.jsx)(j.default,{style:l.text,children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u043d\u0430\u043b\u0430"}),(0,f.jsx)(c.default,{style:{marginBottom:13,alignItems:"center"},children:(0,f.jsx)(le,{value:y.nickname,setValue:function(e){return m(Re(Re({},y),{},{nickname:e}))},placeholder:"",type:"nickname",flex:!0})}),(0,f.jsx)(c.default,{children:(0,f.jsx)(w,{title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",onPress:H,disabled:!U})})]})})]})}function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Ae=function(e){return(0,f.jsxs)(d(),Te(Te({xmlns:"http://www.w3.org/2000/svg",width:50,height:50,fill:"none"},e),{},{children:[(0,f.jsxs)(u.G,{clipPath:"url(#a)",children:[(0,f.jsx)(u.Circle,{cx:25,cy:25,r:25,fill:"#00F"}),(0,f.jsx)(u.Path,{fill:"#fff",d:"M24.846 22.692A4.161 4.161 0 0 1 29 26.846v.004a4.154 4.154 0 1 1-7.09-2.939 3.986 3.986 0 0 1 2.876-1.22h.063-.003v.001Zm10.154-6h.055c1.002 0 1.908.414 2.554 1.081l.001.001a3.547 3.547 0 0 1 1.082 2.555v.058-.003 12.924A3.693 3.693 0 0 1 35 37H14.692A3.693 3.693 0 0 1 11 33.308V20.33c0-1.002.414-1.908 1.081-2.554l.001-.001a3.547 3.547 0 0 1 2.555-1.082h.058-.003 3.23l.735-1.962c.212-.507.557-.922.993-1.213l.01-.006A2.55 2.55 0 0 1 21.15 13h7.387c.542.01 1.067.19 1.499.517l-.006-.005c.445.297.791.712.996 1.201l.007.018.735 1.962L35 16.692ZM24.846 33.308l.091.001a6.206 6.206 0 0 0 4.472-1.896l.002-.002a6.205 6.205 0 0 0 1.897-4.474l-.001-.096v.005l.001-.092a6.206 6.206 0 0 0-1.896-4.472l-.002-.002a6.421 6.421 0 0 0-4.565-1.897 6.424 6.424 0 0 0-4.565 1.896 6.206 6.206 0 0 0-1.896 4.57v-.005l-.001.094c0 1.755.726 3.34 1.894 4.471l.002.002a6.205 6.205 0 0 0 4.474 1.897l.097-.001h-.005l.001.001Z"})]}),(0,f.jsx)(u.Defs,{children:(0,f.jsx)(u.ClipPath,{id:"a",children:(0,f.jsx)(u.Path,{fill:"#fff",d:"M0 0h50v50H0z"})})})]}))};var Ve=n(9108),Ue=n(5211);function We(e){var t=e.placeholderImageSource,n=e.selectedImage,r=e.isAvatar,o=function(){var e=(0,L.default)();return e.width,e.height,y.default.create({Avatarimage:{width:139,height:139,borderRadius:100}})}(),a=null!==n?{uri:n}:t;return(0,f.jsx)(Ue.Image,{source:a,style:r&&o.Avatarimage})}var He=n(8113),Ze=["children"];function Ne(e){e.children,(0,B.default)(e,Ze);var t=(0,i.useContext)(O).updateSelectedImage,n=function(){var e=(0,L.default)();return e.width,e.height,y.default.create({container:{flex:1,justifyContent:"center",flexDirection:"row"},round:{alignItems:"center",justifyContent:"center",height:155,width:155,borderWidth:.7,borderRadius:100,borderColor:"#0000FF"},nonePhoto:{height:139,width:139,backgroundColor:"#D9D9D9",borderRadius:100,justifyContent:"center",alignItems:"center"}})}(),r=(0,i.useState)(null),l=(0,o.default)(r,2),s=(l[0],l[1]),u=(0,i.useState)(null),d=(0,o.default)(u,2),h=d[0],p=d[1],g=(0,i.useContext)(F),m=g.user;g.updateUser;(0,i.useEffect)((function(){(0,a.default)((function*(){var e=yield Ve.requestMediaLibraryPermissionsAsync();s("granted"===e.status)}))()}));var j=function(){var e=(0,a.default)((function*(){var e=yield Ve.launchImageLibraryAsync({allowsEditing:!0,quality:1});e.canceled||b(e)}));return function(){return e.apply(this,arguments)}}(),b=function(){var e=(0,a.default)((function*(e){var n=new FormData,r=yield fetch(e.uri),o=yield r.blob();n.append("file",o,"file.jpg");var a="https://messengerproject-production.up.railway.app/api/users/"+(null==m?void 0:m.id)+"/update/image";try{var i=yield He.default.put(a,n,{headers:{"Content-Type":"multipart/form-data",Authorization:"Basic "+btoa("admin:root")}});200!==i.status&&201!==i.status||(console.log("Image uploaded successfully"),p(e.uri),t(e.uri))}catch(l){l.response&&l.response.data&&l.response.data.message&&alert("Error: "+l.response.data.message)}}));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,a.default)((function*(){if(!1!==(yield Ve.requestCameraPermissionsAsync()).granted){var e=yield Ve.launchCameraAsync();e.canceled||(p(e.assets[0].uri),b(e.assets[0]))}else alert("You've refused to allow this app to access your camera!")}));return function(){return e.apply(this,arguments)}}();return(0,f.jsx)(c.default,{style:n.container,children:(0,f.jsxs)(c.default,{style:n.round,children:[(0,f.jsxs)(R.default,{onPress:j,children:[!h&&(0,f.jsx)(c.default,{style:n.nonePhoto,children:(0,f.jsx)(J,{})}),h&&(0,f.jsx)(We,{isAvatar:!0,selectedImage:h})]}),(0,f.jsx)(c.default,{style:{position:"absolute",bottom:0,right:0},children:(0,f.jsx)(R.default,{onPress:w,children:(0,f.jsx)(Ae,{})})})]})})}function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Ge=function(e){return(0,f.jsxs)(d(),Je(Je({xmlns:"http://www.w3.org/2000/svg",width:104,height:105,fill:"none"},e),{},{children:[(0,f.jsx)(u.G,{filter:"url(#a)",children:(0,f.jsx)(u.Rect,{width:96,height:96,x:4,y:.444,fill:"#fff",rx:12})}),(0,f.jsx)(u.Path,{stroke:"#000",strokeLinecap:"round",strokeWidth:3,d:"M39.5 15.444 18 36.944m0 0 21.5 21.5M18 36.944h52.5c18 0 14.5 21.5 14.5 21.5s2 22-14.5 22H18"}),(0,f.jsx)(u.Defs,{})]}))};function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const qe=function(e){return(0,f.jsx)(d(),$e($e({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none"},e),{},{children:(0,f.jsx)(u.Path,{stroke:"#000",strokeWidth:1.9,d:"M2 24h43.84M2 24l21.92 21.92M2 24 23.92 2.08M45.84 24 23.92 45.92M45.84 24 23.92 2.08m0 43.84V2.08"})}))};var Xe=["value","setValue","flex"];function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function et(e){var t,n=e.value,r=e.setValue,o=e.flex,a=(0,B.default)(e,Xe),i=function(){var e=(0,L.default)();return e.width,e.height,y.default.create({container:{justifyContent:"center",alignItems:"center",backgroundColor:"#FFFFFF"},input:{flex:1,height:60,fontFamily:"Montserrat-Regular",fontSize:48,paddingLeft:"5%",backgroundColor:"#FFFFFF",color:"#000000",width:"70%"}})}(),l=(0,L.default)(),s=l.width,u=l.height;t={maxLength:10};var d=o?"20%":.2*s,h=o?44:.06*u;return(0,f.jsx)(c.default,{style:[i.container,{width:d,height:h}],children:(0,f.jsx)(M.default,Qe(Qe(Qe({},a),t),{},{maxLength:10,placeholderTextColor:"#7C858E",value:n,style:[i.input,{paddingLeft:.5*h}],onChangeText:function(e){return r(e)}}))})}function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rt(e){var t=e.navigation,n=xe(),r=(0,i.useContext)(O).selectedImage,l=(0,i.useContext)(F),s=l.user,u=(l.updateUser,(0,i.useState)({name:(null==s?void 0:s.name)||""})),d=(0,o.default)(u,2),h=d[0],p=d[1],g=(h.name,(0,i.useState)("")),y=(0,o.default)(g,2),m=y[0],v=y[1];(0,K.useFocusEffect)(i.useCallback((function(){P()}),[s]));var P=function(){var e=(0,a.default)((function*(){try{var e=yield function(){return Be.apply(this,arguments)}();e&&e!==m?v(e):e||m||v((null==s?void 0:s.email)||"")}catch(t){console.log("Error retrieving profile email:",t)}}));return function(){return e.apply(this,arguments)}}(),C=(0,i.useRef)(null),S=(0,i.useState)(36),k=(0,o.default)(S,2),E=k[0],D=k[1],I=(0,i.useState)(!1),B=(0,o.default)(I,2),M=B[0],z=B[1],L=(0,i.useState)(0),T=(0,o.default)(L,2),A=(T[0],T[1]);(0,i.useEffect)((function(){V(),U()}),[]);var V=function(){var e=C.current.offsetWidth,t=Math.min(36,300/e*36);D(t)},U=function(){var e=(0,a.default)((function*(){try{var e=yield x.default.getItem("profile_nickname");e&&p({name:e})}catch(t){console.log("Error fetching saved nickname:",t)}}));return function(){return e.apply(this,arguments)}}(),W=function(){var e=(0,a.default)((function*(){if(M){z(!1),A(0);try{yield function(e){return ke.apply(this,arguments)}(h.name),h.name!==s.name&&(yield Z(h.name))}catch(t){console.log("Error saving nickname:",t)}}else z(!0),A(90);try{var e=yield Ee();console.log("Profile nickname:",e)}catch(t){console.log("Error retrieving profile nickname:",t)}}));return function(){return e.apply(this,arguments)}}(),H={transform:"rotate("+(M?45:0)+"deg)",transition:"transform 0.5s ease"},Z=function(){var e=(0,a.default)((function*(e){try{var t=null==s?void 0:s.id;if(t)(yield fetch("https://messengerproject-production.up.railway.app/api/users/"+t+"/update/name?name="+encodeURIComponent(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("admin:root")}})).ok||console.error("Failed to update name")}catch(n){console.error("Error updating name:",n)}}));return function(t){return e.apply(this,arguments)}}();return(0,f.jsxs)(c.default,{style:n.containerMain,children:[(0,f.jsxs)(c.default,{style:n.profileSettingsContainer,children:[(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(Ne,{children:r})}),(0,f.jsxs)(c.default,{style:n.nicknameContainer,children:[M?(0,f.jsx)(et,{value:h.name,setValue:function(e){return p(nt(nt({},h),{},{name:e}))},flex:!1}):(0,f.jsx)(j.default,{style:{fontSize:48,fontFamily:"Montserrat-Regular",paddingHorizontal:30},children:h.name}),(0,f.jsx)(R.default,{onPress:W,children:(0,f.jsx)(qe,{style:H})})]}),(0,f.jsx)(c.default,{style:{borderTopWidth:1,borderBottomWidth:1,borderColor:"#000000",paddingHorizontal:10,paddingVertical:15,width:"80%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginBottom:13},children:(0,f.jsx)(c.default,{ref:C,onLayout:V,children:(0,f.jsx)(j.default,{style:{color:"#000000",fontSize:E,textAlign:"center",fontFamily:"Montserrat-Regular",marginBottom:13},children:m||s.email})})}),(0,f.jsx)(c.default,{children:(0,f.jsx)(w,{title:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0447\u0442\u0443",onPress:function(){return t.navigate("ChangeEmail")}})}),(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(w,{title:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c",onPress:function(){return t.navigate("ChangePassword")}})})]}),(0,f.jsx)(c.default,{style:n.topLeft,children:(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainAuth")},children:(0,f.jsx)(Ge,{})})})]})}function ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function at(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const it=function(e){var t=e.navigation,n=v(),r=(0,i.useState)({email:"",code:""}),l=(0,o.default)(r,2),s=l[0],u=l[1],d=(0,i.useState)(""),h=(0,o.default)(d,2),p=h[0],g=h[1],y=(0,i.useContext)(F),m=y.user,j=(y.updateUser,"admin"),x="root",O=function(){var e=(0,a.default)((function*(){if(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(s.email))try{var e="https://messengerproject-production.up.railway.app/api/users/"+(null==m?void 0:m.id)+"/update/email?email="+encodeURIComponent(s.email);(yield fetch(e,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(j+":"+x)}})).ok?(alert("Email updated successfully"),function(e){Ie.apply(this,arguments)}(s.email)):alert("Failed to update email")}catch(t){console.error("Error updating email:",t),alert("Failed to update email")}else alert("Invalid email format")}));return function(){return e.apply(this,arguments)}}();return(0,f.jsxs)(c.default,{style:n.containerMain,children:[(0,f.jsxs)(c.default,{style:n.textContainer,children:[(0,f.jsxs)(c.default,{style:n.inputContainer,children:[(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:s.email,setValue:function(e){return u(at(at({},s),{},{email:e}))},placeholder:"\u041f\u043e\u0447\u0442\u0430",type:"email",flex:!1})}),(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:s.code,setValue:function(e){return u(at(at({},s),{},{code:e}))},placeholder:"\u041a\u043e\u0434",type:"code",flex:!1})})]}),(0,f.jsx)(c.default,{children:(0,f.jsx)(w,{title:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0447\u0442\u0443",onPress:O,disabled:!s.email||!s.code||s.code!=p})}),(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(w,{title:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043a\u043e\u0434",onPress:function(){var e=encodeURIComponent(s.email);fetch("https://messengerproject-production.up.railway.app/api/send_email?email="+e,{method:"GET",headers:{Authorization:"Basic "+btoa(j+":"+x)}}).then((function(e){return e.json()})).then((function(e){g(e),e?alert("Code has been sent to your email"):alert("Failed to get code")})).catch((function(e){console.error("Error getting code:",e),alert("Failed to get code")}))},disabled:!s.email})})]}),(0,f.jsx)(c.default,{style:n.topLeft,children:(0,f.jsx)(b.default,{onPress:function(){return t.navigate("Profile")},children:(0,f.jsx)(Ge,{})})})]})};function lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ct=function(e){var t=e.navigation,n=v(),r=(0,i.useState)({newPassword:"",password:"",confirmPassword:""}),l=(0,o.default)(r,2),s=l[0],u=l[1],d=(0,i.useContext)(F).user,h=(null==d||d.id,function(){var e=(0,a.default)((function*(){if(s.newPassword!==s.confirmPassword)return alert("New password does not match the confirmation one");var e=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/;if(e.test(s.password)||e.test(s.newPassword)){var t=null==d?void 0:d.id,n=new URLSearchParams({last_password:s.password,new_password:s.newPassword});try{(yield fetch("https://messengerproject-production.up.railway.app/api/users/"+t+"/update/password?"+n.toString(),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("admin:root")}})).ok?alert("Password updated"):console.error("Failed to update password")}catch(r){console.error("Error updating password:",r)}}else alert("Invalid password: at least 8 characters long, should contain at least one uppercase letter, at least one lowercase letter,at least one digit, may contain special characters")}));return function(){return e.apply(this,arguments)}}());return(0,f.jsxs)(c.default,{style:n.containerMain,children:[(0,f.jsxs)(c.default,{style:n.textContainer,children:[(0,f.jsxs)(c.default,{style:n.inputContainer,children:[(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:s.password,setValue:function(e){return u(st(st({},s),{},{password:e}))},placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",flex:!1})}),(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:s.newPassword,setValue:function(e){return u(st(st({},s),{},{newPassword:e}))},placeholder:"\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",type:"password",flex:!1})}),(0,f.jsx)(c.default,{style:{marginBottom:13},children:(0,f.jsx)(le,{value:s.confirmPassword,setValue:function(e){return u(st(st({},s),{},{confirmPassword:e}))},placeholder:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c",type:"password",flex:!1})})]}),(0,f.jsx)(c.default,{children:(0,f.jsx)(w,{title:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c",onPress:h,disabled:!s.newPassword||!s.password||!s.confirmPassword})})]}),(0,f.jsx)(c.default,{style:n.topLeft,children:(0,f.jsx)(b.default,{onPress:function(){return t.navigate("Profile")},children:(0,f.jsx)(Ge,{})})})]})};function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ft=function(e){return(0,f.jsx)(d(),dt(dt({xmlns:"http://www.w3.org/2000/svg",width:15,height:21,fill:"none"},e),{},{children:(0,f.jsx)(u.Path,{stroke:"#000",d:"M14 1H1v18l6.24-5.4L14 19V1Z"})}))};function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const gt=function(e){return(0,f.jsxs)(d(),pt(pt({xmlns:"http://www.w3.org/2000/svg",width:15,height:21,fill:"none"},e),{},{children:[(0,f.jsx)(u.Path,{fill:"#0076B9",d:"M14 1H1v18l6.24-5.4L14 19V1Z"}),(0,f.jsx)(u.Path,{fill:"#000",fillOpacity:.2,d:"M14 1H1v18l6.24-5.4L14 19V1Z"}),(0,f.jsx)(u.Path,{stroke:"#0076B9",d:"M14 1H1v18l6.24-5.4L14 19V1Z"}),(0,f.jsx)(u.Path,{stroke:"#000",strokeOpacity:.2,d:"M14 1H1v18l6.24-5.4L14 19V1Z"})]}))};const yt=function(e){var t=e.data,n=(e.currentUser,t.imageUrl),r=t.nickname,l=t.role,s=t.message,u=t.own,d=t.channel,h=t.date,p=t.unauth,g=t.ident,m=(0,i.useState)(!1),b=(0,o.default)(m,2),w=b[0],v=b[1],x=new Date(h).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),O=(0,i.useContext)(F).user,P=function(){var e=(0,L.default)();return e.width,e.height,y.default.create({container:{flexDirection:"row",alignItems:"flex-end",marginBottom:10,maxWidth:"100%"},ownContainer:{flexDirection:"row-reverse",alignItems:"flex-end",marginBottom:10,maxWidth:"100%"},avatar:{alignSelf:"flex-start"},messageBox:{backgroundColor:"#E7DEDE",paddingVertical:10,paddingHorizontal:15,maxWidth:"60%"},box:{borderTopRightRadius:10,borderBottomRightRadius:10,borderTopLeftRadius:10},ownMessageBox:{backgroundColor:"rgba(0, 118, 185, 0.35)",paddingVertical:10,paddingHorizontal:15,maxWidth:"60%",borderTopRightRadius:10,borderBottomRightRadius:10,borderTopLeftRadius:10},forward:{alignSelf:"flex-end",marginBottom:5},ownForward:{alignSelf:"flex-start",marginBottom:5},nickname:{fontSize:24,fontFamily:"Montserrat-Bold",fontWeight:"bold",color:"black",marginBottom:5},role:{fontSize:24,fontFamily:"Montserrat-Regular",color:"#0076B9",marginBottom:5},message:{fontSize:19,fontFamily:"Montserrat-Regular",color:"black",flexWrap:"wrap",marginBottom:5},time:{fontSize:14,fontFamily:"Montserrat-Regular",color:"black",alignSelf:"flex-end"},ownTime:{fontSize:14,fontFamily:"Montserrat-Regular",color:"black",alignSelf:"flex-start"}})}(),C=((0,i.useContext)(Se).addForwardedMessage,function(){var e=(0,a.default)((function*(){v((function(e){return!e}));var e={username:O.name,messageId:g};try{(yield fetch("https://messengerproject-production.up.railway.app/api/saved_message/save",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("admin:root")},body:JSON.stringify(e)})).ok?console.log("Message forwarded successfully"):console.log("Failed to forward message")}catch(t){console.log("Error forwarding message:",t)}}));return function(){return e.apply(this,arguments)}}()),S=w?(0,f.jsx)(gt,{}):(0,f.jsx)(ft,{}),k=[P.messageBox,u?P.ownMessageBox:P.box,{borderTopRightRadius:10,borderBottomRightRadius:u?0:10,borderBottomLeftRadius:u?10:0}];return(0,f.jsxs)(c.default,{style:u?P.ownContainer:P.container,children:[!u&&n&&(0,f.jsx)(c.default,{style:P.avatar,children:(0,f.jsx)(G,{imageUrl:n,profile:!1})}),(0,f.jsxs)(c.default,{style:k,children:[!p&&(0,f.jsx)(R.default,{onPress:C,children:(0,f.jsx)(c.default,{style:u?P.ownForward:P.forward,children:S})}),(0,f.jsx)(j.default,{style:P.nickname,children:r}),d&&(0,f.jsx)(j.default,{style:P.role,children:l}),(0,f.jsx)(j.default,{style:P.message,children:s}),(0,f.jsx)(j.default,{style:u?P.ownTime:P.time,children:x})]})]})};function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const bt=function(e){return(0,f.jsxs)(d(),jt(jt({xmlns:"http://www.w3.org/2000/svg",width:60,height:60,fill:"none"},e),{},{children:[(0,f.jsx)(u.G,{filter:"url(#a)",children:(0,f.jsx)(u.Circle,{cx:30,cy:28.125,r:28.125,fill:"#fff"})}),(0,f.jsx)(u.Path,{stroke:"#0076B9",strokeWidth:3,d:"M44.25 28.125 22.125 9.375v18.75m22.125 0L22.125 50.625V28.125m22.125 0H22.125"}),(0,f.jsx)(u.Path,{stroke:"#000",strokeOpacity:.2,strokeWidth:3,d:"M44.25 28.125 22.125 9.375v18.75m22.125 0L22.125 50.625V28.125m22.125 0H22.125"}),(0,f.jsx)(u.Defs,{})]}))};const wt=function(e){var t=e.curuser,n=e.chanInf,r=e.channel,l=e.onMessageSent,s=(0,i.useState)(""),u=(0,o.default)(s,2),d=u[0],h=u[1],p=(0,L.default)(),g=(p.width,p.height,function(){var e=(0,L.default)();return e.width,e.height,y.default.create({container:{flexDirection:"row",alignItems:"flex-end"},input:{flex:1,height:44,fontSize:16,paddingLeft:40,borderRadius:10,backgroundColor:"#FFFFFF",color:"#000000",boxShadow:"2px 2px 2px rgba(0, 0, 0, 1)",fontFamily:"Montserrat-Regular",alignSelf:"flex-start",marginRight:30},sendButton:{alignSelf:"flex-end",marginLeft:30,width:60,height:60,alignItems:"center",justifyContent:"center"}})}()),m="admin",j="root",b=function(){var e=(0,a.default)((function*(){if(d)try{if(r){var e={currentUsername:t,message:d,channelName:n.name};(yield fetch("https://messengerproject-production.up.railway.app/api/channels/add_message",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(m+":"+j)},body:JSON.stringify(e)})).ok?(console.log("Message sent successfully"),h(""),l()):console.log("Failed to send message")}else{var o={currentUsername:t,otherUsername:n,message:d};(yield fetch("https://messengerproject-production.up.railway.app/api/chats/add_message",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(m+":"+j)},body:JSON.stringify(o)})).ok?(console.log("Message sent successfully"),h(""),l()):console.log("Failed to send message")}}catch(a){console.error("Error sending message:",a)}}));return function(){return e.apply(this,arguments)}}();return(0,f.jsxs)(c.default,{style:g.container,children:[(0,f.jsx)(M.default,{style:g.input,placeholder:"Type your message here...",value:d,onChangeText:h}),(0,f.jsx)(R.default,{style:g.sendButton,onPress:b,children:(0,f.jsx)(bt,{})})]})};function vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vt(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ot(e){var t=e.navigation,n=e.route.params.chatUser,r=xe(),l=(0,i.useState)(!1),s=(0,o.default)(l,2),u=s[0],d=s[1],h=(0,i.useState)({nickname:""}),p=(0,o.default)(h,2),g=p[0],y=p[1],m=(0,i.useContext)(F),v=m.user,P=(m.updateUser,(0,i.useContext)(F).logout),C=(0,i.useContext)(O).selectedImage,S=(0,i.useState)([]),k=(0,o.default)(S,2),E=k[0],D=k[1],B=(0,i.useState)([]),M=(0,o.default)(B,2),R=M[0],L=M[1],T="admin",A="root",V=(0,i.useState)(""),U=(0,o.default)(V,2),W=U[0],H=U[1],Z=function(){var e=(0,a.default)((function*(){try{var e=yield fetch("https://messengerproject-production.up.railway.app/api/channels/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(T+":"+A)},body:JSON.stringify({username:v.name,channelName:g.nickname})});if(e.ok){yield e.json();d(!1),alert("Channel created"),window.location.reload()}else alert("Failed to create channel")}catch(t){alert("Error creating channel:",t)}}));return function(){return e.apply(this,arguments)}}(),N=(0,i.useState)(!0),_=(0,o.default)(N,2),J=_[0],Y=_[1];(0,K.useFocusEffect)(i.useCallback((function(){q(),Y(!0)}),[])),(0,i.useEffect)((function(){J&&$().then((function(){return Y(!1)})).catch((function(e){return console.log("Error fetching chat data:",e)}))}),[J]),(0,i.useEffect)((function(){var e=setInterval((function(){Y(!0)}),5e3);return function(){return clearInterval(e)}}),[]);var $=function(){var e=(0,a.default)((function*(){var e="https://messengerproject-production.up.railway.app/api/chats/usernames?first_user="+v.name+"&second_user="+n.name;try{var t=yield fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(T+":"+A)}});if(!t.ok)throw new Error("Failed to fetch chat data");var r=yield t.json();L(r)}catch(o){throw new Error("Error fetching chat data:",o)}}));return function(){return e.apply(this,arguments)}}(),q=function(){var e=(0,a.default)((function*(){try{var e=yield Ee();e&&e!==W&&H(e)}catch(t){console.log("Error retrieving profile nickname:",t)}}));return function(){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){re()}),[]),(0,i.useEffect)((function(){ne()}),[E]);var Q=C||v&&v.image,ee=g.nickname,te=[{onPress:function(e){return(0,we.default)(e),t.navigate("Profile")},text:"\u041c\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"},{onPress:function(){return P()},text:"\u0412\u044b\u0439\u0442\u0438"}],ne=function(){var e=(0,a.default)((function*(){try{yield x.default.setItem("chatMessages",JSON.stringify(E))}catch(e){console.error("Error while saving chat messages:",e)}}));return function(){return e.apply(this,arguments)}}(),re=function(){var e=(0,a.default)((function*(){try{var e=yield x.default.getItem("chatMessages");e&&D(JSON.parse(e))}catch(t){console.error("Error while loading chat messages:",t)}}));return function(){return e.apply(this,arguments)}}();return(0,f.jsxs)(c.default,{style:r.containerMain,children:[(0,f.jsx)(c.default,{style:r.barContainer,children:(0,f.jsx)(X,{data:{avatarUrl:n.image,username:n.name,onPress:$}})}),(0,f.jsxs)(c.default,{style:r.profileContainer,children:[(0,f.jsx)(G,{imageUrl:Q,profile:!0}),(0,f.jsx)(j.default,{style:{color:"#000000",fontSize:48,textAlign:"center",marginBottom:13,fontFamily:"Montserrat-Regular"},children:W||v.name}),te.map((function(e,t){return(0,f.jsx)(c.default,{style:{width:"70%"},children:(0,f.jsx)(Oe,{data:e})},t)}))]}),(0,f.jsx)(c.default,{style:r.historyContainer,children:(0,f.jsx)(z.default,{style:{flex:1,scrollbarWidth:0,flexDirection:"column"},children:null==R?void 0:R.map((function(e){var t,n,r;return(0,f.jsx)(yt,{data:{imageUrl:null==(t=e.author)?void 0:t.image,nickname:null==(n=e.author)?void 0:n.name,message:e.data,date:e.date,own:(null==(r=e.author)?void 0:r.name)===v.name,channel:!1,unauth:!1,ident:e.id},currentUser:v},e.id)}))})}),(0,f.jsx)(c.default,{style:r.sendContainer,children:(0,f.jsx)(wt,{channel:!1,curuser:W||v.name,chanInf:n.name,onMessageSent:function(){Y(!0)}})}),(0,f.jsx)(c.default,{style:r.bottomLeft,children:(0,f.jsx)(b.default,{onPress:function(){return d(!0)},children:(0,f.jsx)(I,{})})}),(0,f.jsx)(ve.default,{visible:u,transparent:!0,children:(0,f.jsxs)(c.default,{style:r.popupContainer,children:[(0,f.jsx)(j.default,{style:r.text,children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u043d\u0430\u043b\u0430"}),(0,f.jsx)(c.default,{style:{marginBottom:13,alignItems:"center"},children:(0,f.jsx)(le,{value:g.nickname,setValue:function(e){return y(xt(xt({},g),{},{nickname:e}))},placeholder:"",type:"nickname",flex:!0})}),(0,f.jsx)(c.default,{children:(0,f.jsx)(w,{title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",onPress:Z,disabled:!ee})})]})})]})}function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const St=function(e){return(0,f.jsxs)(d(),Ct(Ct({xmlns:"http://www.w3.org/2000/svg",width:14,height:56,fill:"none"},e),{},{children:[(0,f.jsx)(u.Circle,{cx:7,cy:7,r:7,fill:"#373535"}),(0,f.jsx)(u.Circle,{cx:7,cy:49,r:7,fill:"#373535"}),(0,f.jsx)(u.Circle,{cx:7,cy:28,r:7,fill:"#373535"})]}))};function Ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Et(e){var t,n=e.navigation,r=e.route,l=xe(),s=r.params.channelId,u=(0,i.useState)(!1),d=(0,o.default)(u,2),h=d[0],p=d[1],g=(0,i.useState)("Admin"),y=(0,o.default)(g,2),m=(y[0],y[1],(0,i.useState)({nickname:""})),v=(0,o.default)(m,2),P=v[0],C=v[1],S=(0,i.useContext)(F).logout,k=(0,i.useContext)(F),E=k.user,D=(k.updateUser,(0,i.useState)([])),B=(0,o.default)(D,2),M=B[0],R=B[1],L=(0,i.useContext)(O).selectedImage,T=(0,i.useState)(!1),A=(0,o.default)(T,2),V=A[0],U=A[1],W=(0,i.useState)(!1),H=(0,o.default)(W,2),Z=H[0],N=H[1],_=(0,i.useState)(!1),J=(0,o.default)(_,2),Y=J[0],$=J[1],q=(0,i.useState)(!0),X=(0,o.default)(q,2),Q=X[0],ee=(X[1],(0,i.useState)("")),te=(0,o.default)(ee,2),ne=te[0],re=te[1],oe="admin",ae="root",ie=(0,i.useState)([]),se=(0,o.default)(ie,2),ce=se[0],ue=se[1],de=(0,i.useState)(!0),fe=(0,o.default)(de,2),he=fe[0],pe=fe[1],ge=function(){var e=(0,a.default)((function*(){try{var e=yield fetch("https://messengerproject-production.up.railway.app/api/channels/"+s,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(oe+":"+ae)}});if(!e.ok)throw new Error("Failed to fetch channel data");var t,n,r=yield e.json(),o=(null==E?void 0:E.id)===(null==(t=r.creator)?void 0:t.id),a=null==(n=E.channels)?void 0:n.some((function(e){return e.id===r.id})),i=r.members.find((function(e){return e.user.id===E.id}));if(i){var l=i.role;l&&void 0!==l.isAdmin&&$(l.isAdmin)}U(a),N(o),ue(r)}catch(c){throw new Error("Error fetching channel data:",c)}}));return function(){return e.apply(this,arguments)}}();(0,K.useFocusEffect)(i.useCallback((function(){ye(),pe(!0)}),[])),(0,i.useEffect)((function(){he&&ge().then((function(){return pe(!1)})).catch((function(e){return console.log("Error fetching chat data:",e)}))}),[he]),(0,i.useEffect)((function(){var e=setInterval((function(){pe(!0)}),5e3);return function(){return clearInterval(e)}}),[]);var ye=function(){var e=(0,a.default)((function*(){try{var e=yield Ee();e&&e!==ne&&re(e)}catch(t){console.log("Error retrieving profile nickname:",t)}}));return function(){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){Fe(),console.log(s)}),[]),(0,i.useEffect)((function(){Ce()}),[M]),(0,i.useEffect)((function(){Pe()}),[V,Q]);var me=P.nickname,je=[{onPress:function(e){return(0,we.default)(e),n.navigate("Profile")},text:"\u041c\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"},{onPress:function(){return S()},text:"\u0412\u044b\u0439\u0442\u0438"}],be=function(){var e=(0,a.default)((function*(){try{var e=ne||E.name,t=ce.name,n=V?"https://messengerproject-production.up.railway.app/api/channels/"+s+"/leave?username="+e:"https://messengerproject-production.up.railway.app/api/channels/join?username="+e+"&channel_name="+t;(yield fetch(n,{method:V?"DELETE":"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(oe+":"+ae)}})).ok?(U((function(e){return!e})),alert(V?"You left the channel":"You joined the channel"),window.location.reload()):alert(V?"Failed to leave the channel":"Failed to join the channel")}catch(r){alert("Error joining/leaving the channel:",r)}}));return function(){return e.apply(this,arguments)}}(),Pe=function(){var e=(0,a.default)((function*(){try{var e={isMember:V,showSettings:Q};yield x.default.setItem("channelState",JSON.stringify(e))}catch(t){console.error("Error while saving channel state:",t)}}));return function(){return e.apply(this,arguments)}}(),Ce=function(){var e=(0,a.default)((function*(){try{yield x.default.setItem("chatMessages",JSON.stringify(M))}catch(e){console.error("Error while saving chat messages:",e)}}));return function(){return e.apply(this,arguments)}}(),Se=L||E&&E.image,Fe=function(){var e=(0,a.default)((function*(){try{var e=yield x.default.getItem("chatMessages");e&&R(JSON.parse(e))}catch(t){console.error("Error while loading chat messages:",t)}}));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=(0,a.default)((function*(){try{var e=yield fetch("https://messengerproject-production.up.railway.app/api/channels/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(oe+":"+ae)},body:JSON.stringify({username:E.name,channelName:P.nickname})});if(e.ok){yield e.json();p(!1),alert("Channel created"),window.location.reload()}else alert("Failed to create channel")}catch(t){alert("Error creating channel:",t)}}));return function(){return e.apply(this,arguments)}}();return(0,f.jsxs)(c.default,{style:l.containerMain,children:[(0,f.jsxs)(c.default,{style:l.barChanContainer,children:[(0,f.jsx)(j.default,{style:l.barText,children:ce.name}),(0,f.jsx)(c.default,{children:(0,f.jsx)(w,{title:V?"\u041f\u043e\u043a\u0438\u043d\u0443\u0442\u044c":"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f",onPress:be,disabled:Z})}),V&&Y&&(0,f.jsx)(c.default,{style:{marginRight:20},children:(0,f.jsx)(b.default,{onPress:function(e){return(0,we.default)(e),n.navigate("Settings",{channelId:ce.id})},children:(0,f.jsx)(St,{})})})]}),(0,f.jsxs)(c.default,{style:l.profileContainer,children:[(0,f.jsx)(G,{imageUrl:Se,profile:!0}),(0,f.jsx)(j.default,{style:{color:"#000000",fontSize:48,textAlign:"center",marginBottom:13,fontFamily:"Montserrat-Regular"},children:ne||E.name}),je.map((function(e,t){return(0,f.jsx)(c.default,{style:{width:"70%"},children:(0,f.jsx)(Oe,{data:e},t)},t)}))]}),(0,f.jsx)(c.default,{style:l.historyContainer,children:(0,f.jsx)(z.default,{style:{flex:1,scrollbarWidth:0,flexDirection:"column"},children:null==ce||null==(t=ce.messages)?void 0:t.map((function(e){var t,n,r,o,a,i=null==(t=e.sender)?void 0:t.id,l=ce.members.find((function(e){return e.user.id===i})),s=null==l||null==(n=l.role)?void 0:n.name;return(0,f.jsx)(yt,{data:{imageUrl:null==(r=e.sender)?void 0:r.image,nickname:null==(o=e.sender)?void 0:o.name,role:s,message:e.data,date:e.date,own:(null==(a=e.sender)?void 0:a.name)===E.name,channel:!0,unauth:!1,ident:e.id},currentUser:E},e.id)}))})}),V&&(0,f.jsx)(c.default,{style:l.sendContainer,children:(0,f.jsx)(wt,{channel:!0,curuser:ne||E.name,chanInf:ce,onMessageSent:function(){pe(!0)}})}),(0,f.jsx)(c.default,{style:l.bottomLeft,children:(0,f.jsx)(b.default,{onPress:function(){return p(!0)},children:(0,f.jsx)(I,{})})}),(0,f.jsx)(ve.default,{visible:h,transparent:!0,children:(0,f.jsxs)(c.default,{style:l.popupContainer,children:[(0,f.jsx)(j.default,{style:l.text,children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u043d\u0430\u043b\u0430"}),(0,f.jsx)(c.default,{style:{marginBottom:13,alignItems:"center"},children:(0,f.jsx)(le,{value:P.nickname,setValue:function(e){return C(kt(kt({},P),{},{nickname:e}))},placeholder:"",type:"nickname",flex:!0})}),(0,f.jsx)(c.default,{children:(0,f.jsx)(w,{title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",onPress:ke,disabled:!me})})]})})]})}function Dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function It(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Bt=function(e){return(0,f.jsxs)(d(),It(It({xmlns:"http://www.w3.org/2000/svg",width:44,height:42,fill:"none"},e),{},{children:[(0,f.jsx)(u.Path,{fill:"#373535",d:"M1 40.444v-8.5l24.5-23 8.5 8-24.5 23.5H1ZM38 12.944l-8.5-8s2.5-2.5 4.5-3.5 4 0 4 0 4 1.5 4 3.5.5 3 0 4-4 4-4 4Z"}),(0,f.jsx)(u.Path,{stroke:"#373535",strokeWidth:1.9,d:"M1 40.444v-8.5l24.5-23 8.5 8-24.5 23.5H1ZM38 12.944l-8.5-8s2.5-2.5 4.5-3.5 4 0 4 0 4 1.5 4 3.5.5 3 0 4-4 4-4 4Z"})]}))};function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const zt=function(e){return(0,f.jsx)(d(),Rt(Rt({xmlns:"http://www.w3.org/2000/svg",width:67,height:67,fill:"none"},e),{},{children:(0,f.jsx)(u.Circle,{cx:33.5,cy:33.5,r:23,stroke:"#000"})}))};function Lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const At=function(e){return(0,f.jsxs)(d(),Tt(Tt({xmlns:"http://www.w3.org/2000/svg",width:67,height:67,fill:"none"},e),{},{children:[(0,f.jsx)(u.Circle,{cx:33.5,cy:33.5,r:23,fill:"#0076B9"}),(0,f.jsx)(u.Circle,{cx:33.5,cy:33.5,r:23,fill:"#000",fillOpacity:.2}),(0,f.jsx)(u.Circle,{cx:33.5,cy:33.5,r:23,stroke:"#000"})]}))};function Vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vt(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wt(e){var t=e.data,n=t.role,r=t.name,l=(t.onPress,t.containerStyle),s=t.creator,u=t.channelId,d=(0,i.useState)(!1),h=(0,o.default)(d,2),p=h[0],g=h[1],m=(0,i.useState)(!1),b=(0,o.default)(m,2),v=b[0],x=b[1],O=(0,i.useContext)(F).user,P=(0,i.useState)({nickname:"",role:n}),C=(0,o.default)(P,2),S=C[0],k=C[1],E=function(){var e=(0,L.default)();return e.width,e.height,y.default.create({container:{backgroundColor:"#FFFFFF",borderRadius:26,paddingVertical:12,paddingHorizontal:16},text:{fontFamily:"Montserrat-Regular",color:"#000000",fontSize:24,textAlign:"center",marginBottom:13},content:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",flex:1},username:{fontFamily:"Montserrat-Regular",fontSize:24,color:"#000000",marginLeft:40},role:{fontFamily:"Montserrat-Regular",fontSize:24,color:"#0076B9",marginLeft:40,marginRight:40},inputContainer:{flexDirection:"row",alignItems:"center"},popupContainer:{backgroundColor:"#E7DEDE",borderRadius:35,padding:20,shadowColor:"#000",shadowOffset:{width:2,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:7,position:"absolute",top:"50%",left:"50%",transform:[{translateX:"-50%"},{translateY:"-50%"}],width:"30%",height:"30%",justifyContent:"center",alignItems:"center",flexDirection:"column"}})}(),D=(0,i.useState)(!1),I=(0,o.default)(D,2),B=I[0],M=I[1],z="admin",T="root",A=function(){var e=(0,a.default)((function*(){try{var e="https://messengerproject-production.up.railway.app/api/channels/"+u.id+"/leave?username="+r,t=yield He.default.delete(e,{auth:{username:z,password:T}});console.log("Delete request sent successfully"),console.log(t.data)}catch(n){console.error("Error sending delete request:",n)}}));return function(){return e.apply(this,arguments)}}(),V=S.role,U=(u.members.find((function(e){return e.user.id===O.id})),function(){var e=(0,a.default)((function*(){var e={name:S.role,isAdmin:B,username:r,channelName:u.name};try{(yield fetch("https://messengerproject-production.up.railway.app/api/roles/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(z+":"+T)},body:JSON.stringify(e)})).ok?console.log("Role created successfully"):(console.log("Failed to create role"),console.log(u.name))}catch(t){console.error("Error creating role:",t)}x(!1)}));return function(){return e.apply(this,arguments)}}());return(0,f.jsxs)(R.default,{style:[E.container,l,p&&{backgroundColor:"#E7DEDE"}],onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)},children:[(0,f.jsxs)(c.default,{style:E.content,children:[!s&&(0,f.jsx)(R.default,{onPress:A,children:(0,f.jsx)(q,{})}),(0,f.jsx)(j.default,{style:E.username,children:r}),(0,f.jsx)(j.default,{style:E.role,children:S.role}),!s&&(0,f.jsx)(R.default,{onPress:function(){return x(!0)},children:(0,f.jsx)(Bt,{})})]}),(0,f.jsx)(ve.default,{visible:v,transparent:!0,children:(0,f.jsxs)(c.default,{style:E.popupContainer,children:[(0,f.jsx)(j.default,{style:E.text,children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0440\u043e\u043b\u0438"}),(0,f.jsxs)(c.default,{style:E.inputContainer,children:[(0,f.jsx)(le,{value:S.role,setValue:function(e){return k(Ut(Ut({},S),{},{role:e}))},placeholder:"",type:"nickname",flex:!0}),(0,f.jsx)(R.default,{style:E.adminButton,onPress:function(){M(!B)},children:B?(0,f.jsx)(At,{}):(0,f.jsx)(zt,{})})]}),(0,f.jsx)(c.default,{children:(0,f.jsx)(R.default,{onPress:function(){return x(!1)},children:(0,f.jsx)(w,{title:"\u041d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c",onPress:U,disabled:!V})})})]})})]})}function Ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nt(e){var t,n=e.navigation,r=e.route.params.channelId,l=(0,i.useContext)(F).user,s=xe(),u=(0,i.useState)(!1),d=(0,o.default)(u,2),h=d[0],p=d[1],g=(0,i.useState)(""),y=(0,o.default)(g,2),m=(y[0],y[1]),j=(0,i.useState)(!1),v=(0,o.default)(j,2),O=v[0],P=v[1],C=(0,i.useState)([]),S=(0,o.default)(C,2),k=S[0],E=S[1],D="admin",I="root";(0,K.useFocusEffect)(i.useCallback((function(){T()}),[k.members]));var B=(0,i.useState)({nickname:k.name||"a"}),M=(0,o.default)(B,2),R=M[0],L=M[1],T=function(){var e=(0,a.default)((function*(){try{var e=yield fetch("https://messengerproject-production.up.railway.app/api/channels/"+r,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(D+":"+I)}});if(e.ok){var t,n=yield e.json();E(n),L((function(e){return Zt(Zt({},e),{},{nickname:n.name||"a"})}));var o=(null==l?void 0:l.id)===(null==(t=n.creator)?void 0:t.id);p(o)}else console.log("Failed to fetch channel data")}catch(a){console.log("Error fetching channel data:",a)}}));return function(){return e.apply(this,arguments)}}(),A=function(){var e=(0,a.default)((function*(){try{(yield fetch("https://messengerproject-production.up.railway.app/api/channels/delete/"+r,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(D+":"+I)}})).ok?(alert("Channel deleted"),n.navigate("MainAuth")):alert("Failed to delete channel")}catch(e){alert("Error deleting channel:",e)}}));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,a.default)((function*(e){m(e);try{yield x.default.setItem("role",e)}catch(t){console.log("Error saving role:",t)}}));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=(0,a.default)((function*(){if(O){P(!1);try{var e=yield fetch("https://messengerproject-production.up.railway.app/api/channels/"+r+"/update?name="+encodeURIComponent(R.nickname),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(D+":"+I)}});if(e.ok){var t=yield e.json(),n=l.channels.map((function(e){return e.id===t.id?Zt(Zt({},e),{},{name:t.name}):e})),o=Zt(Zt({},l),{},{channels:n});localStorage.setItem("user",JSON.stringify(o))}else console.log("Failed to update Channel name")}catch(a){console.log("Error updating Channel name:",a)}}else P(!0)}));return function(){return e.apply(this,arguments)}}();return(0,f.jsxs)(c.default,{style:s.containerSettings,children:[(0,f.jsxs)(c.default,{style:s.channNameContainer,children:[(0,f.jsx)(c.default,{style:s.dataInputContainer,children:(0,f.jsx)(le,{value:R.nickname,setValue:function(e){return L(Zt(Zt({},R),{},{nickname:e}))},placeholder:"",type:"nickname",flex:!1,editable:O})}),(0,f.jsx)(b.default,{onPress:U,children:(0,f.jsx)(qe,{})})]}),(0,f.jsx)(c.default,{style:s.settingsContainer,children:(0,f.jsx)(z.default,{style:{flex:1,scrollbarWidth:0,flexDirection:"column"},children:null==(t=k.members)?void 0:t.map((function(e){return(0,f.jsx)(Wt,{data:{key:e.id,name:e.user.name,role:e.role.name,onRoleChange:V,creator:e.role.isCreator,channelId:k}})}))})}),(0,f.jsx)(c.default,{style:s.topLeft,children:(0,f.jsx)(b.default,{onPress:function(){return n.navigate("Channel",{channelId:k.id})},children:(0,f.jsx)(Ge,{})})}),(0,f.jsx)(c.default,{style:s.bottomLeft,children:(0,f.jsx)(w,{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u043d\u0430\u043b",onPress:A,disabled:!h})})]})}function _t(e){var t,n=e.navigation,r=e.route,l=xe(),s=r.params.channelId,u=(0,i.useState)(!1),d=(0,o.default)(u,2),h=(d[0],d[1]);(0,i.useEffect)((function(){h(!1)}),[s]),(0,K.useFocusEffect)(i.useCallback((function(){S()}),[s]));var p=(0,i.useState)([]),g=(0,o.default)(p,2),y=g[0],m=g[1],v=(0,i.useRef)(null),x=(0,i.useState)(!0),O=(0,o.default)(x,2),P=O[0],C=O[1];(0,i.useEffect)((function(){var e;(null==y||null==(e=y.messages)?void 0:e.length)>0&&P&&v.current.scrollToEnd({animated:!0})}),[null==y?void 0:y.messages,P]);var S=function(){var e=(0,a.default)((function*(){try{var e=yield fetch("https://messengerproject-production.up.railway.app/api/channels/"+s,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("admin:root")}});if(e.ok){var t=yield e.json();m(t)}else console.log("Failed to fetch channel data")}catch(n){console.log("Error fetching channel data:",n)}}));return function(){return e.apply(this,arguments)}}();return y?(0,f.jsxs)(c.default,{style:l.containerMain,children:[(0,f.jsxs)(c.default,{style:l.barChanContainer,children:[(0,f.jsx)(j.default,{style:l.barText,children:y.name}),(0,f.jsx)(c.default,{children:(0,f.jsx)(w,{title:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f",onPress:function(){return n.navigate("Auth")}})})]}),(0,f.jsx)(c.default,{style:l.historyContainer,children:(0,f.jsx)(z.default,{ref:v,onContentSizeChange:function(){var e=v.current&&v.current.contentOffset&&v.current.contentOffset.y+v.current.layoutMeasurement.height>=v.current.contentSize.height;C(e)},style:{flex:1,scrollbarWidth:0,flexDirection:"column"},children:null==y||null==(t=y.messages)?void 0:t.map((function(e){var t,n,r,o,a=null==(t=e.sender)?void 0:t.id,i=y.members.find((function(e){return e.user.id===a})),l=null==i||null==(n=i.role)?void 0:n.name;return(0,f.jsx)(yt,{data:{imageUrl:null==(r=e.sender)?void 0:r.image,nickname:null==(o=e.sender)?void 0:o.name,role:l,message:e.data,date:e.date,own:!1,channel:!0,unauth:!0}},e.id)}))})}),(0,f.jsx)(c.default,{style:l.bottomLeft,children:(0,f.jsx)(b.default,{onPress:function(){return n.navigate("Auth")},children:(0,f.jsx)(I,{})})})]}):null}var Jt=n(316);function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yt(){var e=(0,s.default)(),t=(0,i.useState)(""),n=(0,o.default)(t,2),u=n[0],d=n[1],h=(0,i.useState)([]),p=(0,o.default)(h,2),g=(p[0],p[1],"admin"),y="root",m=(0,i.useState)([]),j=(0,o.default)(m,2),v=j[0],x=j[1],O=(0,i.useState)([]),C=(0,o.default)(O,2),F=C[0],E=C[1];(0,i.useEffect)((function(){var e=function(){var e=(0,a.default)((function*(){try{var e=yield fetch("http://localhost:8080/api/channels",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(g+":"+y)}});if(e.ok){for(var t=yield e.json(),n=[],r=[],o=function*(){var e=t[a];n.push({name:e.name,onPress:function(t){return t.navigation.navigate("Channel",{channelId:e.id})},avatarUrl:null}),r.push({name:e.name,onPress:function(t){return t.navigation.navigate("ChannelUnauth",{channelId:e.id})},avatarUrl:null})},a=0;a<t.length;a++)yield*o();var i=yield fetch("http://localhost:8080/api/users",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa(g+":"+y)}});if(i.ok)for(var l=yield i.json(),s=function*(){var e=l[c];n.push({name:e.name,onPress:function(t){return t.navigation.navigate("Chat",{chatUser:e})},avatarUrl:e.image})},c=0;c<l.length;c++)yield*s();else console.log("Failed to fetch user data");E(n),x(r)}else console.log("Failed to fetch channel data")}catch(u){console.log("Error fetching data:",u)}}));return function(){return e.apply(this,arguments)}}();e()}),[]);var D=[{name:"Greetings",component:k,options:function(e){var t=e.navigation;return{title:"",headerLeft:function(){return(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainUnauth")},children:(0,f.jsx)(be,{style:{marginLeft:20}})})},headerRight:function(){return(0,f.jsx)(w,{style:{marginRight:20},title:"\u0412\u043e\u0439\u0442\u0438",onPress:function(){return t.navigate("Auth")}})},headerShadowVisible:!0,headerStyle:{height:100,borderBottomWidth:1,borderBottomColor:"#ccc",backgroundColor:"#fff",elevation:3,justifyContent:"space-between",flexDirection:"row",alignItems:"center",paddingHorizontal:20}}}},{name:"MainUnauth",component:re,options:function(e){var t=e.navigation;return{title:"",headerLeft:function(){return(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainUnauth")},children:(0,f.jsx)(be,{style:{marginLeft:20}})})},headerRight:function(){return(0,f.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,f.jsx)(ne,{style:{marginRight:10},value:u,setValue:d,results:v,navigation:t,unauth:!0}),(0,f.jsx)(c.default,{style:{paddingHorizontal:193}}),(0,f.jsx)(w,{style:{marginLeft:10},title:"\u0412\u043e\u0439\u0442\u0438",onPress:function(){return t.navigate("Auth")}})]})},headerShadowVisible:!0,headerStyle:{height:100,borderBottomWidth:1,borderBottomColor:"#ccc",backgroundColor:"#fff",elevation:3,justifyContent:"space-between",flexDirection:"row",alignItems:"center",paddingHorizontal:20}}}},{name:"ChannelUnauth",component:_t,options:function(e){var t=e.navigation;e.route;return{title:"",headerLeft:function(){return(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainUnauth")},children:(0,f.jsx)(be,{style:{marginLeft:20}})})},headerRight:function(){return(0,f.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,f.jsx)(ne,{style:{marginRight:10},value:u,setValue:d,results:v,unauth:!0,navigation:t}),(0,f.jsx)(c.default,{style:{paddingHorizontal:193}}),(0,f.jsx)(w,{style:{marginLeft:10},title:"\u0412\u043e\u0439\u0442\u0438",onPress:function(){return t.navigate("Auth")}})]})},headerShadowVisible:!0,headerStyle:{height:100,borderBottomWidth:1,borderBottomColor:"#ccc",backgroundColor:"#fff",elevation:3,justifyContent:"space-between",flexDirection:"row",alignItems:"center",paddingHorizontal:20}}}},{name:"Settings",component:Nt,options:function(e){var t=e.navigation;e.route;return{title:"",headerLeft:function(){return(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainAuth")},children:(0,f.jsx)(be,{style:{marginLeft:20}})})},headerRight:function(){return(0,f.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,f.jsx)(ne,{style:{marginRight:10},value:u,setValue:d,results:F,navigation:t}),(0,f.jsx)(c.default,{style:{paddingHorizontal:30}})]})},headerShadowVisible:!0,headerStyle:{height:100,borderBottomWidth:1,borderBottomColor:"#ccc",backgroundColor:"#fff",elevation:3,justifyContent:"space-between",flexDirection:"row",alignItems:"center",paddingHorizontal:20}}}},{name:"MainAuth",component:ze,options:function(e){var t=e.navigation;return{title:"",headerLeft:function(){return(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainAuth")},children:(0,f.jsx)(be,{style:{marginLeft:20}})})},headerRight:function(){return(0,f.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,f.jsx)(ne,{style:{marginRight:10},value:u,setValue:d,results:F,navigation:t}),(0,f.jsx)(c.default,{style:{paddingHorizontal:30}})]})},headerShadowVisible:!0,headerStyle:{height:100,borderBottomWidth:1,borderBottomColor:"#ccc",backgroundColor:"#fff",elevation:3,justifyContent:"space-between",flexDirection:"row",alignItems:"center",paddingHorizontal:20}}}},{name:"Chat",component:Ot,options:function(e){var t=e.navigation;e.route;return{title:"",headerLeft:function(){return(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainAuth")},children:(0,f.jsx)(be,{style:{marginLeft:20}})})},headerRight:function(){return(0,f.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,f.jsx)(ne,{style:{marginRight:10},value:u,setValue:d,results:F,navigation:t}),(0,f.jsx)(c.default,{style:{paddingHorizontal:30}})]})},headerShadowVisible:!0,headerStyle:{height:100,borderBottomWidth:1,borderBottomColor:"#ccc",backgroundColor:"#fff",elevation:3,justifyContent:"space-between",flexDirection:"row",alignItems:"center",paddingHorizontal:20}}}},{name:"Channel",component:Et,options:function(e){var t=e.navigation;e.route;return{title:"",headerLeft:function(){return(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainAuth")},children:(0,f.jsx)(be,{style:{marginLeft:20}})})},headerRight:function(){return(0,f.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,f.jsx)(ne,{style:{marginRight:10},value:u,setValue:d,results:F,navigation:t}),(0,f.jsx)(c.default,{style:{paddingHorizontal:30}})]})},headerShadowVisible:!0,headerStyle:{height:100,borderBottomWidth:1,borderBottomColor:"#ccc",backgroundColor:"#fff",elevation:3,justifyContent:"space-between",flexDirection:"row",alignItems:"center",paddingHorizontal:20}}}},{name:"Profile",component:rt,options:function(e){var t=e.navigation;return{title:"",headerLeft:function(){return(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainAuth")},children:(0,f.jsx)(be,{style:{marginLeft:20}})})},headerRight:function(){return(0,f.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,f.jsx)(ne,{style:{marginRight:10},value:u,setValue:d,results:F,navigation:t}),(0,f.jsx)(c.default,{style:{paddingHorizontal:30}})]})},headerShadowVisible:!0,headerStyle:{height:100,borderBottomWidth:1,borderBottomColor:"#ccc",backgroundColor:"#fff",elevation:3,justifyContent:"space-between",flexDirection:"row",alignItems:"center",paddingHorizontal:20}}}},{name:"ChangePassword",component:ct,options:function(e){var t=e.navigation;return{title:"",headerLeft:function(){return(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainAuth")},children:(0,f.jsx)(be,{style:{marginLeft:20}})})},headerRight:function(){return(0,f.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,f.jsx)(ne,{style:{marginRight:10},value:u,setValue:d,results:F,navigation:t}),(0,f.jsx)(c.default,{style:{paddingHorizontal:30}})]})},headerShadowVisible:!0,headerStyle:{height:100,borderBottomWidth:1,borderBottomColor:"#ccc",backgroundColor:"#fff",elevation:3,justifyContent:"space-between",flexDirection:"row",alignItems:"center",paddingHorizontal:20}}}},{name:"ChangeEmail",component:it,options:function(e){var t=e.navigation;return{title:"",headerLeft:function(){return(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainAuth")},children:(0,f.jsx)(be,{style:{marginLeft:20}})})},headerRight:function(){return(0,f.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,f.jsx)(ne,{style:{marginRight:10},value:u,setValue:d,results:F,navigation:t}),(0,f.jsx)(c.default,{style:{paddingHorizontal:30}})]})},headerShadowVisible:!0,headerStyle:{height:100,borderBottomWidth:1,borderBottomColor:"#ccc",backgroundColor:"#fff",elevation:3,justifyContent:"space-between",flexDirection:"row",alignItems:"center",paddingHorizontal:20}}}},{name:"Auth",component:ue,options:function(e){var t=e.navigation;return{title:"",headerLeft:function(){return(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainUnauth")},children:(0,f.jsx)(be,{style:{marginLeft:20}})})},headerRight:function(){return(0,f.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,f.jsx)(ne,{style:{marginRight:10},value:u,setValue:d,results:F,navigation:t,unauth:!0}),(0,f.jsx)(c.default,{style:{paddingHorizontal:193}}),(0,f.jsx)(w,{style:{marginLeft:10},title:"\u0412\u043e\u0439\u0442\u0438",onPress:function(){return t.navigate("Auth")}})]})},headerShadowVisible:!0,headerStyle:{height:100,borderBottomWidth:1,borderBottomColor:"#ccc",backgroundColor:"#fff",elevation:3,justifyContent:"space-between",flexDirection:"row",alignItems:"center",paddingHorizontal:20}}}},{name:"Reg",component:he,options:function(e){var t=e.navigation;return{title:"",headerLeft:function(){return(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainUnauth")},children:(0,f.jsx)(be,{style:{marginLeft:20}})})},headerRight:function(){return(0,f.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,f.jsx)(ne,{style:{marginRight:10},value:u,setValue:d,results:F,navigation:t,unauth:!0}),(0,f.jsx)(c.default,{style:{paddingHorizontal:193}}),(0,f.jsx)(w,{style:{marginLeft:10},title:"\u0412\u043e\u0439\u0442\u0438",onPress:function(){return t.navigate("Auth")}})]})},headerShadowVisible:!0,headerStyle:{height:100,borderBottomWidth:1,borderBottomColor:"#ccc",backgroundColor:"#fff",elevation:3,justifyContent:"space-between",flexDirection:"row",alignItems:"center",paddingHorizontal:20}}}},{name:"Forgot",component:ye,options:function(e){var t=e.navigation;return{title:"",headerLeft:function(){return(0,f.jsx)(b.default,{onPress:function(){return t.navigate("MainUnauth")},children:(0,f.jsx)(be,{style:{marginLeft:20}})})},headerRight:function(){return(0,f.jsxs)(c.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,f.jsx)(ne,{style:{marginRight:10},value:u,setValue:d,results:F,navigation:t,unauth:!0}),(0,f.jsx)(c.default,{style:{paddingHorizontal:193}}),(0,f.jsx)(w,{style:{marginLeft:10},title:"\u0412\u043e\u0439\u0442\u0438",onPress:function(){return t.navigate("Auth")}})]})},headerShadowVisible:!0,headerStyle:{height:100,borderBottomWidth:1,borderBottomColor:"#ccc",backgroundColor:"#fff",elevation:3,justifyContent:"space-between",flexDirection:"row",alignItems:"center",paddingHorizontal:20}}}}];return(0,f.jsx)(P,{children:(0,f.jsx)(S,{children:(0,f.jsx)(Fe,{children:(0,f.jsx)(l.default,{children:(0,f.jsx)(e.Navigator,{children:D.map((function(t){return(0,f.jsx)(e.Screen,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t),t.name)}))})})})})})}(function(){var e=(0,a.default)((function*(){yield Jt.loadAsync({"Montserrat-Regular":n(3564),"Montserrat-Italic":n(435),"Montserrat-Bold":n(5159)})}));return function(){return e.apply(this,arguments)}})()().then((function(){renderApp()})).catch((function(e){console.error("Error loading fonts:",e)}))},5159:(e,t,n)=>{e.exports=n.p+"static/media/Montserrat-Bold.0915f0a8c3367a6d05ec.ttf"},435:(e,t,n)=>{e.exports=n.p+"static/media/Montserrat-Italic.ce3a49f8e6c790a13ba0.ttf"},3564:(e,t,n)=>{e.exports=n.p+"static/media/Montserrat-Regular.2a2d37bf7680d86811db.ttf"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.m=e,(()=>{var e=[];n.O=(t,r,o,a)=>{if(!r){var i=1/0;for(u=0;u<e.length;u++){for(var[r,o,a]=e[u],l=!0,s=0;s<r.length;s++)(!1&a||i>=a)&&Object.keys(n.O).every((e=>n.O[e](r[s])))?r.splice(s--,1):(l=!1,a<i&&(i=a));if(l){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,o,a]}})(),n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"===typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&o&&r;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>i[e]=()=>r[e]));return i.default=()=>r,n.d(a,i),a}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={179:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,a,[i,l,s]=r,c=0;if(i.some((t=>0!==e[t]))){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(s)var u=s(n)}for(t&&t(r);c<i.length;c++)a=i[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},r=self.webpackChunkweb=self.webpackChunkweb||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n.O(void 0,[124],(()=>n(8029)));r=n.O(r)})();
//# sourceMappingURL=main.438a648b.js.map